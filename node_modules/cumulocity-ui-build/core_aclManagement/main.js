/* core_aclManagement 8.21.0 2018-01-30T22:07:34+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
angular.module("c8y.parts.aclManagement",[]),function(){"use strict";function e(e,t,n,s,c,i,a){function r(e){return t.when(l(e||{})).then(function(e){return _.union(["*"],e)})}function o(){r(e.device).then(function(e){h.suggestedTypes=e})}function l(e){return p(d.MANAGED_OBJECT)?n.getFragments(e):p(d.OPERATION)?n.getSupportedOperations(e):p(d.MEASUREMENT)&&!_.isUndefined(e.id)?n.getSupportedMeasurements(e):[]}function p(t){var n=e.scope;return!!n&&n.name===t.name}function u(){i.isCurrentUserTopTenant().then(m)}function m(t){var n=[];n.push(a("ALARM")),n.push(a("AUDIT")),n.push(a("EVENT")),n.push(a("MANAGED_OBJECT")),n.push(a("MEASUREMENT")),n.push(a("OPERATION")),t&&n.push(a("SUPPORT")),n.push("*"),d=c.createEnum(n),e.scopeTypes=d.values()}var d={},h=this,g=c.createEnum([a("READ"),a("ADMIN"),"*"]),y=a("Object's fragment type (e.g. c8y_IsDevice) to which you grant permission. Note that to have access to an object, user has to have access to all its fragments. Use an asterisk (*) to grant permission to any object's fragment type.");u(),e.properties=e,e.accessTypes=g.values(),e.typeTooltip=y,window.c8y_testing?e.getSuggestedTypes=r:e.$watchGroup(["device","scope"],o)}angular.module("c8y.parts.aclManagement").controller("permissionEditorCtrl",["$scope","$q","c8yDevices","c8yUser","c8yBase","c8yTenant","gettext",e])}(),angular.module("c8y.parts.aclManagement").directive("c8yDevicePermission",function(){"use strict";return{restrict:"E",scope:{scope:"=",permissionType:"=",access:"=",device:"="},templateUrl:"core_aclManagement/views/permissionEditor.html",controller:"permissionEditorCtrl",controllerAs:"$ctrl"}}),function(){"use strict";function e(e){var t;t='\n<!-- ng-model hack -->\n<!-- required because directive\'s scope is truthy, and 2-way binding is lost for primitive -->\n<!-- types when modified. -->\n<div class="form-group selectize-container">\n  <label class="control-label">{{\'Scope\' | translate}}</label>\n  <ui-select class="form-control" ng-model="properties.scope">\n    <ui-select-match placeholder="{{\'Select or search\' | translate}}">{{$select.selected.name | translate}}</ui-select-match>\n    <ui-select-choices repeat="st in scopeTypes | filter: $select.search" position="down">\n      <div ng-bind-html="st.name | translate | highlight: $select.search"></div>\n    </ui-select-choices>\n  </ui-select>\n</div>\n\n<div class="form-group">\n  <label for="type-input" class="control-label">\n    {{\'Type\' | translate}}\n    <a tabindex="0" uib-popover="{{typeTooltip | translate}}" popover-append-to-body="true" popover-placement="right" popover-trigger="\'focus\'" style="display:inline-block">\n      <i c8y-icon="question-circle-o"></i>\n    </a>\n  </label>\n  <input id="type-input" type="text" class="form-control direct-edit" maxlength="100" ng-model="permissionType" typeahead="type for type in getSuggestedTypes(device)"/>\n</div>\n\n<div class="form-group selectize-container">\n  <label class="control-label">{{\'Permission\' | translate}}</label>\n  <ui-select class="form-control" ng-model="properties.access">\n    <ui-select-match placeholder="{{\'Select or search\' | translate}}">{{$select.selected.name | translate}}</ui-select-match>\n    <ui-select-choices repeat="pt in accessTypes | filter: $select.search" position="down">\n      <div ng-bind-html="pt.name | translate | highlight: $select.search"></div>\n    </ui-select-choices>\n  </ui-select>\n</div>\n',e.put("core_aclManagement/views/permissionEditor.html",t),e.put("/apps/core/aclManagement/views/permissionEditor.html",t)}angular.module("c8y.parts.aclManagement").run(["$templateCache",e])}();