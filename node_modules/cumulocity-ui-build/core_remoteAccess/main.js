/* core_remoteAccess 8.21.0 2018-01-30T22:09:20+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";function n(n){n.configBlock()}n.$inject=["c8yRemoteAccessUIProvider"],angular.module("c8y.remoteAccess",[]).config(n)}(),function(){"use strict";function n(n,e,t,o,s,c){function i(n){var o=u(n);return e.get(o).then(t.getResData)}function r(n,e){try{return d(n,e)}catch(t){return a(n,e)}}function a(n,o){var s=u(n);return e.post(s,o).then(t.getResData)}function d(n,o){var s=m(n,o);return e.put(s,o).then(t.getResData)}function l(n,o){var s=m(n,o);return e.get(s).then(t.getResData)}function p(n,t){var o=m(n,t);return e.delete(o)}function u(n){var e=[b,"devices",t.getId(n),"configurations"].join("/");return t.url(e)}function m(n,e){return[u(n),t.getId(e)].join("/")}function v(e,t){return n.all({host:h(),path:g(e,t)}).then(function(n){return _.defaults({title:c.getString("Connected to: {{name}}",t),host:n.host,path:n.path},C)})}function g(n,e){return s.current().then(function(s){return f({deviceId:t.getId(n),configurationId:e.id,token:o.encodeToken(s.userName,o.getPassword(),s.tenant)})})}function f(n){return"service/remoteaccess/client/"+n.deviceId+"/configurations/"+n.configurationId+"?token="+n.token}function h(){var n=document.createElement("a");return s.current().then(function(e){return n.href=e.self,n.hostname})}function y(n){return e.head(u(n),{silentError:!0}).then(_.constant(!0),_.constant(!1))}var b="service/remoteaccess",A=t.createEnum(["VNC"]),C={encrypt:!0,true_color:!0,local_cursor:!1,viewport:!0,shared:!0,view_only:!1,disconnectTimeout:10,repeaterID:"",port:443,password:""},E={PROTOCOLS:A,save:r,list:i,detail:l,remove:p,getConnectionParams:v,isMicroServiceAvailable:_.memoize(y)};return E}n.$inject=["$q","$http","c8yBase","c8yAuth","c8yUser","gettextCatalog"],angular.module("c8y.remoteAccess").factory("c8yRemoteAccess",n)}(),function(){"use strict";function n(n,e,t,o){function s(n){this.id=n.deviceId}function c(n,e,t,o){function s(){return t.detail(c).then(e.getResData).then(function(n){return t.supportsOperation(n,"c8y_RemoteAccessConnect")})}var c=n.deviceId;return s().then(function(n){return n&&o.isMicroServiceAvailable(c)})}function i(){r()}function r(){e.when("/"+l,p)}function a(n,e,t,o,s,c,i,r,a,d,l,p,u,m){function v(n){var e=[{label:"localhost",ipAddress:"127.0.0.1"}];return g(n).then(function(n){var t=_.map(n,function(n){return{label:p.properName(n),ipAddress:p.getIPAddress(n)}});return _.filter(e.concat(t),"ipAddress")})}function g(n){return l.childDevices(n)}function f(n){return w(n).then(function(n){return c.list(n).then(function(e){return _.map(e,function(e){return{device:n,config:e}})})})}function h(n){var e=w(n).then(function(n){return i.open({size:"md",component:"c8yRemoteAccessEndpointModal",resolve:{rootDevice:_.constant(_.cloneDeep(n))}}).result}),t=function(n){return c.save(n.device,n.config)},o=_.partial(_.unary(a.success),u("Endpoint saved."));return e.then(t).then(o)}function y(n){var e=w(n.device).then(function(e){return i.open({size:"md",component:"c8yRemoteAccessEndpointModal",resolve:{endpoint:_.constant(_.cloneDeep(n)),rootDevice:_.constant(_.cloneDeep(e))}}).result}),t=function(n){return c.save(n.device,n.config)},o=_.partial(_.unary(a.success),u("Endpoint saved."));return e.then(t).then(o)}function b(n){var e={title:u("Confirm delete?"),body:m.getString('Do you really want to remove endpoint "{{config.name}}" from device "{{device.name}}"?',n),labels:{ok:u("Delete")},status:"danger"},t=r(e),o=_.partial(c.remove,n.device,n.config),s=_.partial(_.unary(a.success),u("Endpoint removed."));return t.then(o).then(s)}function A(n){return c.getConnectionParams(n.device,n.config).then(function(e){var t="remoteConnection_"+n.device.id+"_"+n.config.id,s=I+"?paramsId="+t;o.localStorage.setItem(t,JSON.stringify(e));var c=o.open(s,t,"top=0,left=0,location=no,menubar=no,toolbar=no,status=no,resizable=yes");return C(c,t,e),_.assign(e,{paramsId:t,vncClientWindow:c})})}function C(n,e,s){var c=t(function(){var i;try{i=JSON.parse(o.localStorage.getItem(e))}catch(n){i={}}_.assign(s,i),n.closed&&(t.cancel(c),o.localStorage.removeItem(e),s.status=void 0,s.vncClientWindow=void 0)},1e3)}function E(n){return _.includes(["localhost","127.0.0.1"],n.config.hostname)}function w(e){return _.isObjectLike(e)?n.when(e):l.detail(e).then(d.getResData)}var I="core_remoteAccess/vncClient/vncClient.html",P={getSuggestedIPAddresses:v,getChildDevices:g,getEndpoints:f,addEndpoint:h,editEndpoint:y,removeEndpoint:b,connectEndpoint:A,isLocalEndpoint:E};return P}s.$inject=["$routeParams"],c.$inject=["$routeParams","c8yBase","c8yDevices","c8yRemoteAccess"],a.$inject=["$q","$location","$interval","$window","c8yTitle","c8yRemoteAccess","$uibModal","c8yModal","c8yAlert","c8yBase","c8yInventory","c8yDevices","gettext","gettextCatalog"];var d="window-restore",l="device/:deviceId",p={name:o("Remote access"),icon:d,template:'<c8y-remote-access-endpoints-list device="vm.id"></c8y-remote-access-endpoints-list>',controllerAs:"vm",controller:s,showIf:c};return{$get:a,configBlock:i,hookViews:r}}n.$inject=["c8yNavigatorProvider","c8yViewsProvider","c8yTitleProvider","gettext"],angular.module("c8y.remoteAccess").provider("c8yRemoteAccessUI",n)}(),function(){"use strict";function n(n,e,t,o){function s(n){n.device&&n.device.currentValue&&c(n.device.currentValue)}function c(n){o.getEndpoints(n).then(i)}function i(n){m.endpoints=n}function r(n){var e=o.isLocalEndpoint(n)?"z":"a",t=n.config.name;return e+t}function a(){return o.addEndpoint(m.device).then(u)}function d(n){o.connectEndpoint(n).then(function(e){n.connection=e})}function l(n){o.editEndpoint(n).then(u)}function p(n){o.removeEndpoint(n).then(u)}function u(){c(m.device)}var m=this;_.assign(m,{$onChanges:s,endpointsOrderFn:r,addEndpoint:a,onConnect:d,onEdit:l,onRemove:p})}n.$inject=["$q","c8yBase","c8yInventory","c8yRemoteAccessUI"],angular.module("c8y.remoteAccess").component("c8yRemoteAccessEndpointsList",{bindings:{device:"<"},templateUrl:"core_remoteAccess/remoteAccessEndpointsList/remoteAccessEndpointsList.html",controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n,e,t,o){function s(){c(p.resolve.endpoint,p.resolve.rootDevice),i(p.resolve.rootDevice)}function c(n,e){l=_.get(n,"config.password"),p.passwordAlreadyExists=!_.isUndefined(l),p.endpoint=_.defaults(n,{device:e,config:{hostname:"127.0.0.1",port:5900,protocol:p.protocols[0].name}})}function i(n){e.getSuggestedIPAddresses(n).then(function(n){p.suggestedIPAddresses=n})}function r(){p.modalInstance.close(p.endpoint)}function a(){p.modalInstance.dismiss()}function d(n){p.changingPassword=n,_.set(p.endpoint,"config.password",n?"":l)}var l,p=this;_.assign(p,{protocols:n.PROTOCOLS.values(),ipOrHostnamePattern:new RegExp(o.validation.ip.pattern.source+"|"+o.validation.hostname.pattern.source),$onInit:s,save:r,cancel:a,changePassword:_.partial(d,!0),cancelChangePassword:_.partial(d,!1)})}n.$inject=["c8yRemoteAccess","c8yRemoteAccessUI","c8yDevices","c8yConfig"],angular.module("c8y.remoteAccess").component("c8yRemoteAccessEndpointModal",{bindings:{resolve:"<",modalInstance:"<"},templateUrl:"core_remoteAccess/remoteAccessEndpointModal/remoteAccessEndpointModal.html",controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n,e){function t(){return n.isLocalEndpoint(r.endpoint)}function o(){var n=(r.endpoint.connection||{}).status,e=n&&n.level;return{btn:!0,"btn-block":!0,"btn-default":!n,"btn-warning":"warn"===e,"btn-success":"normal"===e}}function s(){var n=(r.endpoint.connection||{}).vncClientWindow;n&&!n.closed?n.focus():r.onConnect({endpoint:r.endpoint})}function c(){r.onEdit({endpoint:r.endpoint})}function i(){r.onRemove({endpoint:r.endpoint})}var r=this,a=e("Local");_.assign(r,{isLocal:t,labelLocal:a,connectBtnCls:o,connect:s,edit:c,remove:i})}n.$inject=["c8yRemoteAccessUI","gettext"],angular.module("c8y.remoteAccess").component("c8yRemoteAccessEndpointCard",{bindings:{endpoint:"<",onConnect:"&",onEdit:"&",onRemove:"&"},templateUrl:"core_remoteAccess/remoteAccessEndpointCard/remoteAccessEndpointCard.html",controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n){var e;e='<div class="card">\n  <div class="card-block" style="position:relative">\n    <div class="row">\n      <div class="col-md-4">\n        <span class="text-truncate">\n          <i class="fa-local" style="font-size: 1.5em" c8y-icon="{{vm.isLocal() ? \'laptop\' : undefined}}" ng-attr-data-label-local="{{vm.isLocal() ? (vm.labelLocal | translate) : undefined}}">\n          </i>\n          <strong ng-bind="vm.endpoint.config.name" title="{{vm.endpoint.config.name}}"></strong>\n        </span>\n\n      </div>\n\n      <div class="col-md-3">\n        <div class="text-truncate">\n          <label class="text-muted" translate>Host</label>\n          <span ng-bind="vm.endpoint.config.hostname" title="{{vm.endpoint.config.hostname}}"></span>\n        </div>\n        <label class="text-muted" translate>Port</label> <span ng-bind="vm.endpoint.config.port"></span>\n      </div>\n\n      <div class="col-md-2">\n        <label class="text-muted" translate>Protocol</label> <span ng-bind="vm.endpoint.config.protocol"></span>\n      </div>\n\n      <div class="col-md-2">\n        <button ng-click="vm.connect()" ng-class="vm.connectBtnCls()">\n          <span ng-if="!vm.endpoint.connection.status" translate>Connect</span>\n          <span ng-if="vm.endpoint.connection.status" translate>Show</span>\n        </button>\n      </div>\n    </div>\n\n    <div class="card-actions interact">\n      <div class="dropdown settings" uib-dropdown>\n        <a class="dropdown-toggle c8y-dropdown btn btn-link" uib-dropdown-toggle>\n          <i c8y-icon="cog"></i>\n        </a>\n        <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>\n          <li>\n            <a href="" ng-click="vm.edit()">\n              <i c8y-icon="edit"></i>\n              <translate>Edit</translate>\n             </a>\n          </li>\n          <li>\n            <a href="" ng-click="vm.remove()">\n              <i c8y-icon="times"></i>\n              <translate>Remove</translate>\n            </a>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </div>\n</div>\n',n.put("core_remoteAccess/remoteAccessEndpointCard/remoteAccessEndpointCard.html",e),n.put("/apps/core/remoteAccess/remoteAccessEndpointCard/remoteAccessEndpointCard.html",e),e='<div class="modal-header">\n  <h3>\n    <i c8y-icon="{{vm.icons.endpoint}}"></i>\n    <span translate>Remote access endpoint</span>\n  </h3>\n</div>\n<div class="modal-body">\n  <form name="endpointForm" role="form" novalidate>\n    <div class="form-group">\n      <label for="name" translate>\n        Description\n      </label>\n      <input id="name" name="name" type="text" class="form-control" ng-model="vm.endpoint.config.name" placeholder="{{\'Enter description\' | translate}}" ng-maxlength="1000" required>\n      <c8y-error-feedback field="endpointForm.name">\n      </c8y-error-feedback>\n    </div>\n\n    <div class="row">\n      <div class="col-lg-7">\n        <div class="form-group">\n          <label for="hostname" translate>\n            Host\n          </label>\n          <a tabindex="0" uib-popover-html="\'IP address or hostname in the local network\' | translate" popover-append-to-body="true" popover-placement="left" popover-trigger="\'focus\'" style="display:inline-block">\n            <i class="fa fa-question-circle"></i>\n          </a>\n\n          <input id="hostname" name="hostname" type="text" class="form-control" placeholder="{{\'Enter IP, hostname or select device\' | translate}}" ng-model="vm.endpoint.config.hostname" uib-typeahead="suggestedIPAddress.ipAddress as suggestedIPAddress.ipAddress for suggestedIPAddress in vm.suggestedIPAddresses | filter:$viewValue" typeahead-template-url="core_remoteAccess/remoteAccessEndpointModal/suggestedIPAddressTemplate.html" typeahead-show-hint="true" typeahead-min-length="0" ng-pattern="vm.ipOrHostnamePattern" ng-maxlength="255" required>\n          <c8y-error-feedback field="endpointForm.hostname">\n            <span ng-message="pattern" translate>Please provide valid IP address or hostname.</span>\n          </c8y-error-feedback>\n        </div>\n      </div>\n      <div class="col-lg-5">\n        <div class="form-group">\n          <label for="port" translate>\n            Port\n          </label>\n          <input id="port" name="port" type="number" class="form-control" ng-model="vm.endpoint.config.port" placeholder="{{\'e.g. 9000\' | translate}}" ng-min="1" ng-max="65535" required>\n          <c8y-error-feedback field="endpointForm.port">\n          </c8y-error-feedback>\n        </div>\n      </div>\n    </div>\n\n    <div class="form-group">\n      <label for="password" translate>\n        Password\n      </label>\n\n      <div ng-class="{\'input-group\': vm.passwordAlreadyExists}">\n        <input id="password" ng-show="!vm.passwordAlreadyExists || vm.changingPassword" name="password" type="password" class="form-control" ng-model="vm.endpoint.config.password" c8y-autocomplete="off" ng-maxlength="255">\n\n        <input disabled="disabled" style="color:rgba(0,0,0,0.2)" class="form-control" type="password" value="********" ng-show="vm.passwordAlreadyExists && !vm.changingPassword">\n\n        <span class="input-group-btn" ng-show="vm.passwordAlreadyExists">\n          <button class="btn btn-default" ng-hide="vm.changingPassword" ng-click="vm.changePassword()">{{\'Change\' | translate}}</button>\n          <button class="btn btn-default" ng-show="vm.changingPassword" ng-click="vm.cancelChangePassword()">{{\'Cancel\' | translate}}</button>\n        </span>\n      </div>\n\n      <c8y-error-feedback field="endpointForm.password">\n      </c8y-error-feedback>\n    </div>\n\n    <div class="form-group">\n      <label for="protocol" translate>\n        Protocol\n      </label>\n      <select id="protocol" name="protocol" class="form-control" ng-model="vm.endpoint.config.protocol" ng-options="p.value as (p.label | translate) for p in vm.protocols" required readonly="readonly">\n      </select>\n      <c8y-error-feedback field="endpointForm.protocol">\n      </c8y-error-feedback>\n    </div>\n  </form>\n</div>\n<div class="modal-footer">\n  <button class="btn btn-primary" ng-disabled="endpointForm.$pending || endpointForm.$invalid" ng-click="vm.save()" translate>\n    Save\n  </button>\n  <button class="btn btn-default" ng-click="vm.cancel()" translate>\n    Cancel\n  </button>\n</div>\n',n.put("core_remoteAccess/remoteAccessEndpointModal/remoteAccessEndpointModal.html",e),n.put("/apps/core/remoteAccess/remoteAccessEndpointModal/remoteAccessEndpointModal.html",e),e='<a>\r\n  <strong ng-bind-html="match.model.label | uibTypeaheadHighlight:query">\r\n  </strong>\r\n  <p>\r\n    <small class="text-muted" ng-bind-html="match.model.ipAddress | uibTypeaheadHighlight:query">\r\n    </small>\r\n  </p>\r\n</a>\r\n',n.put("core_remoteAccess/remoteAccessEndpointModal/suggestedIPAddressTemplate.html",e),n.put("/apps/core/remoteAccess/remoteAccessEndpointModal/suggestedIPAddressTemplate.html",e),e='<div>\r\n  <h4>\r\n    <span translate>Endpoints</span>\r\n    <a href="" class="btn btn-link pull-right" ng-click="vm.addEndpoint()">\r\n      <i c8y-icon="plus-circle"></i>\r\n      <span translate>Add endpoint</span>\r\n    </a>\r\n  </h4>\r\n\r\n  <hr>\r\n\r\n  <div class="alert alert-info" ng-show="vm.endpoints && vm.endpoints.length === 0">\r\n    <i c8y-icon="info-circle"></i>\r\n    <translate>There are no endpoints defined. <a href="" ng-click="vm.addEndpoint()">Click here</a> to add your first one.</translate>\r\n  </div>\r\n\r\n  <div class="endpoints-list">\r\n    <div ng-repeat="endpoint in vm.endpoints | orderBy:vm.endpointsOrderFn">\r\n      <c8y-remote-access-endpoint-card endpoint="endpoint" on-connect="vm.onConnect(endpoint)" on-edit="vm.onEdit(endpoint)" on-remove="vm.onRemove(endpoint)">\r\n      </c8y-remote-access-endpoint-card>\r\n    </div>\r\n  </div>\r\n</div>\r\n',n.put("core_remoteAccess/remoteAccessEndpointsList/remoteAccessEndpointsList.html",e),n.put("/apps/core/remoteAccess/remoteAccessEndpointsList/remoteAccessEndpointsList.html",e),e='<!DOCTYPE html>\n<html>\n  <head>\n    <title>noVNC</title>\n    <meta charset="utf-8">\n    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">\n    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">\n    <script>\n      var INCLUDE_URI;\n      var NO_VNC_INCLUDE;\n      INCLUDE_URI = NO_VNC_INCLUDE = isDev() ? \'node_modules/noVnc/include/\' : \'\';\n      var LODASH_INCLUDE = isDev() ? \'node_modules/lodash/dist/\' : \'\';\n\n      loadCss(\'base.css\', NO_VNC_INCLUDE);\n      loadJs(\'lodash.min.js\', LODASH_INCLUDE);\n      loadJs(\'util.js\', NO_VNC_INCLUDE);\n      startVncClient();\n\n      function isDev() {\n        var hostname = location.hostname;\n        return hostname === \'localhost\' || hostname === \'127.0.0.1\';\n      }\n\n      function loadCss(css, basePath) {\n        var link = document.createElement(\'link\');\n        link.href = (basePath || \'\') + css;\n        link.type = \'text/css\';\n        link.rel = \'stylesheet\';\n        link.media = \'screen,print\';\n        document.getElementsByTagName(\'head\')[0].appendChild(link);\n      }\n\n      function loadJs(js, basePath) {\n        var script = document.createElement(\'script\');\n        script.src = (basePath || \'\') + js;\n        document.getElementsByTagName(\'head\')[0].appendChild(script);\n      }\n\n      function startVncClient() {\n        window.setTimeout(function () {\n          if (window.Util) {\n            loadJs(\'vncClient.js\');\n          } else {\n            startVncClient();\n          }\n        }, 10);\n      }\n    </script>\n  </head>\n\n  <body>\n    <div id="noVNC_container">\n      <div id="noVNC_status_bar" class="noVNC_status_bar" style="margin-top: 0px">\n        <table border="0" width="100%">\n          <tr>\n            <td>\n              <div id="noVNC_status" style="position: relative; height: auto">\n                Loading\n              </div>\n            </td>\n            <td width="1%">\n              <div id="noVNC_buttons">\n                <input type="button" value="Send Ctrl+Alt+Del" id="sendCtrlAltDelButton">\n                <span id="noVNC_xvp_buttons">\n                  <input type="button" value="Shutdown" id="xvpShutdownButton">\n                  <input type="button" value="Reboot" id="xvpRebootButton">\n                  <input type="button" value="Reset" id="xvpResetButton">\n                </span>\n              </div>\n            </td>\n          </tr>\n        </table>\n      </div>\n      <canvas id="noVNC_canvas" width="640px" height="20px">\n        Canvas not supported.\n      </canvas>\n    </div>\n  </body>\n</html>\n',n.put("core_remoteAccess/vncClient/vncClient.html",e),n.put("/apps/core/remoteAccess/vncClient/vncClient.html",e)}angular.module("c8y.remoteAccess").run(["$templateCache",n])}();