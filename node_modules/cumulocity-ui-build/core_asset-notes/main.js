/* core_asset-notes 8.21.0 2018-01-30T22:07:41+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";function t(t,n){t.add({name:"assetNotesWidget",nameDisplay:n("Asset notes"),description:n("Displays editable asset notes."),widgetComponent:"c8yAssetNotes",transformConfigWithContext:["config","context",function(t,n){return _.assign(t,{context:n})}],options:{groupsSelectable:!0}})}t.$inject=["c8yComponentsProvider","gettext"],angular.module("c8y.assetNotes",[]).config(t)}(),function(){"use strict";function t(t,n,e){function s(){return n.get(a.config.context).then(function(t){a.notes=t})}function o(){a.editable=!0,a.editedNotes=_.cloneDeep(a.notes)}function i(){n.save(a.config.context,a.editedNotes).then(function(t){a.editable=!1,a.notes=t}).then(function(){return t.success(e("Notes saved successfully!"))})}function r(){a.editable=!1,a.editedNotes=void 0}var a=this;_.assign(a,{$onInit:s,edit:o,save:i,cancel:r})}t.$inject=["c8yAlert","assetNotesSvc","gettext"],angular.module("c8y.assetNotes").component("c8yAssetNotes",{bindings:{config:"<"},templateUrl:"core_asset-notes/assetNotes.html",controller:t,controllerAs:"vm"})}(),function(){"use strict";function t(t,n,e){function s(e){var s=t.getId(e);return n.detail(s).then(t.getResData).then(_.property(i)).then(function(t){return t||{}})}function o(s,o){var r=t.getId(s),a={id:r};return e.current().then(function(n){o.user=n.id,o.lastUpdated=moment().format(t.dateFullFormat)}).then(function(){return a[i]=o,a}).then(n.save).then(t.getResData).then(_.property(i))}var i="c8y_ComponentConfig!assetNotes";return{get:s,save:o}}t.$inject=["c8yBase","c8yInventory","c8yUser"],angular.module("c8y.assetNotes").factory("assetNotesSvc",t)}(),function(){"use strict";function t(t){var n;n='<div ng-if="!vm.editable" style="height:100%">\r\n  <div class="flex-row wrap">\r\n    <span c8y-icon="c8y-notification" class="c8y-icon c8y-icon-duocolor asset-notes-icon"></span>\r\n    <div class="asset-notes-content">\r\n      <c8y-rectangle-spinner class="spinner-inline" ng-show="!vm.notes">\r\n      </c8y-rectangle-spinner>\r\n\r\n      <div ng-if="vm.notes && !vm.notes.htmlContent">\r\n        {{\'No notes yet!\' | translate}}\r\n        <c8y-if-allowed admin-mos="[vm.config.context]">\r\n          <a class="small" href="" ng-click="vm.edit()">\r\n            <i c8y-icon="pencil"></i> {{\'Edit\' | translate}}\r\n          </a>\r\n        </c8y-if-allowed>\r\n      </div>\r\n\r\n      <div ng-if="vm.notes && vm.notes.htmlContent" class="text-break-word asset-notes-body">\r\n        <span ng-bind-html="vm.notes.htmlContent"></span>\r\n        <c8y-if-allowed admin-mos="[vm.config.context]">\r\n          <a class="small" href="" ng-click="vm.edit()">\r\n            <i c8y-icon="pencil"></i> {{\'Edit\' | translate}}\r\n          </a>\r\n        </c8y-if-allowed>\r\n      </div>\r\n\r\n      <div class="asset-notes-footer top-m-sm">\r\n        <small class="text-muted">\r\n          <em ng-if="vm.notes.lastUpdated" translate>\r\n            {{vm.notes.lastUpdated | absoluteDate}} by {{vm.notes.user}}\r\n          </em>\r\n        </small>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div ng-if="vm.editable" style="height: 100%">\r\n  <div class="input-group input-group-editable" style="height:100%">\r\n    <textarea class="form-control" style="resize: none; height: 100%" ng-model="vm.editedNotes.htmlContent" c8y-code-editor>\r\n    </textarea>\r\n    <div class="input-group-btn">\r\n      <button type="button" class="btn btn-clean text-success" ng-click="vm.save()" title="{{\'Save\' | translate}}">\r\n      <i c8y-icon="check"></i>\r\n    </button>\r\n  </div>\r\n    <div class="input-group-btn">\r\n      <button type="button" class="btn btn-clean text-danger" ng-click="vm.cancel()" title="{{\'Cancel\' | translate}}">\r\n        <i c8y-icon="times"></i>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n',t.put("core_asset-notes/assetNotes.html",n),t.put("/apps/core/asset-notes/assetNotes.html",n)}angular.module("c8y.assetNotes").run(["$templateCache",t])}();