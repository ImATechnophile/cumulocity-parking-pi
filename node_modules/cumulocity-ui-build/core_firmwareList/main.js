/* core_firmwareList 8.21.0 2018-01-30T22:08:37+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
angular.module("c8y.parts.firmwareList",[]).config(["c8yNavigatorProvider","c8yViewsProvider","gettext",function(n,e,t){"use strict";var i="download",r=t("Firmware");n.addNavigation({parent:t("Management"),name:t("Firmware repository"),priority:1e3,path:"firmware",icon:i}),e.when("/firmware",{name:r,templateUrl:"core_firmwareList/views/index.html"})}]),function(){"use strict";function n(n,e,t,i,r,a,l,o,s,c){function d(){l.changeTitle({title:s("Firmware repository")})}function u(e){n.firmwares&&!n.refreshLoading||(D.firmwares=n.firmwares=[]),n.paging=e.paging,e.forEach(function(e){n.firmwares.push(e)})}function p(n){return _.assign({type:N},n||{})}function m(n){var e=p(n);return t.list(e).then(u)}function f(){n.paging.loading=!0,n.paging.next().then(u).finally(function(){n.paging.loading=!1})}function g(){n.refreshLoading=!0,n.paging.refresh().then(u).finally(function(){n.refreshLoading=!1})}function w(n){return q.indexOf(n)}function v(n){return w(n)>-1}function b(n){v(n)?q.splice(w(n),1):(q.push(n),n.edited={name:n.name,version:n.version})}function y(e){i({title:s("Confirm delete?"),size:"sm",labels:{ok:s("Delete"),cancel:s("Cancel")},body:c.getString('Do you really want to remove firmware "{{name}}"?',{name:e.name}),status:"danger"}).then(angular.bind(t,t.remove,e)).then(angular.bind(r,r.removeFromList,n.firmwares,e)).then(function(){o.success(s("Firmware successfully removed."))})}function h(i){return _.merge(i,i.edited),i.type=N,e.when(i).then(_.partialRight(t.addGlobalFlag,!0)).then(F).then(x).then(k).then(t.save).then(function(){o.success(s("Firmware successfully added.")),g(),$("body").trigger("click"),n.newFw=null})}function F(n){var t=a.getIdFromUrl(n.selectedFile.url),i=t?a.setGlobalFlag(t,!0):e.when();return i.then(_.constant(n))}function x(n){return n.url=n.selectedFile.url,delete n.selectedFile,n}function k(n){return _.unset(n,"edited"),n}function L(){D.newFw=n.newFw={type:N}}function C(){D.newFw=n.newFw=null}function S(n){n?L():C()}var D=this,N="c8y_Firmware",q=[];n.loadNext=f,n.refresh=g,n.toggle=b,n.isOpen=v,n.onClickDelete=y,n.save=h,n.add=L,n.cancelAdd=C,n.toggled=S,m(),d()}n.$inject=["$scope","$q","c8yInventory","c8yModal","c8yBase","c8yBinary","c8yTitle","c8yAlert","gettext","gettextCatalog"],angular.module("c8y.parts.firmwareList").controller("firmwareListCtrl",n)}(),function(){"use strict";function n(n){var e;e='<div data-ng-controller="firmwareListCtrl as vm">\n\n  <c8y-ui-action-bar-set>\n    <li action-bar-position="left" class="navbar-form" ng-show="vm.firmwares.length > 0">\n      <div class="input-group input-group-search">\n        <input type="search" class="form-control" placeholder="{{\'Filter\' | translate}}&hellip;" ng-model="vm.searchString"/>\n        <span class="input-group-addon">\n            <i c8y-icon="search" ng-show="vm.searchString.length === 0 || !vm.searchString "></i>\n            <i c8y-icon="times" class="text-muted" ng-show="vm.searchString.length > 0" ng-click="vm.searchString = \'\'"></i>\n        </span>\n      </div>\n    </li>\n\n    <div class="dropdown" uib-dropdown auto-close="outsideClick" is-open="false" on-toggle="toggled(open)">\n      <button class="dropdown-toggle c8y-dropdown" uib-dropdown-toggle aria-haspopup="true" aria-expanded="false">\n        <span><i c8y-icon="plus-circle"></i> <translate>Add firmware</translate></span>\n      </button>\n      <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>\n        <li class="dropdown-form">\n          <form role="form" name="newFirmware" novalidate>\n            <div class="form-group">\n              <label translate>Name</label>\n              <input type="text" class="form-control" ng-model="vm.newFw.name" required>\n            </div>\n            <div class="form-group">\n              <label translate>Version</label>\n              <input type="text" class="form-control" ng-model="vm.newFw.version">\n            </div>\n            <div class="form-group">\n              <label translate>File</label>\n              <c8y-binary-input initial-url="vm.newFw.url" set-global="true" output-file="vm.newFw.selectedFile" allow-free-url-input="true" file-required="true"></c8y-binary-input>\n            </div>\n            <button class="btn btn-primary btn-block" ng-click="save(vm.newFw)" ng-disabled="newFirmware.$invalid" translate>Save</button>\n          </form>\n        </li>\n      </ul>\n    </div>\n\n    <c8y-refresh-btn></c8y-refresh-btn>\n  </c8y-ui-action-bar-set>\n\n  <div class="c8y-empty-state text-center" ng-show="firmwares.length === 0">\n    <h1><i c8y-icon="download"></i></h1>\n    <h3 translate>No firmwares to display.</h3>\n    <p translate>Add a firmware using the button on the toolbar.</p>\n  </div>\n\n  <div class="card-group interact-grid">\n    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3" ng-repeat="fw in firmwares | filter:vm.searchString | orderBy:[\'name\',\'version\']">\n      <div class="card-flip-container" ng-class="{\'flipping\': isFlipped}">\n        <div class="card-flip" ng-class="{\'flipped\': isFlipped}">\n\n          <div class="card card-front">\n\n            <div class="card-actions">\n              <span class="dropdown settings" is-open="false" uib-dropdown>\n              <button type="button" class="dropdown-toggle c8y-dropdown" uib-dropdown-toggle aria-haspopup="true" aria-expanded="false">\n                <i c8y-icon="ellipsis-v"></i>\n              </button>\n              <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>\n                <li>\n                  <button type="button" ng-click="onClickDelete(fw)">\n                    <i c8y-icon="trash"></i> {{\'Delete firmware\' | translate}}\n                  </button>\n                </li>\n              </ul>\n            </span>\n            </div>\n            <div class="card-block text-center flex-col flex-center" style="min-height: 260px">\n              <div class="dot" style="margin: 0 0 10px 0"><i c8y-icon="download"></i></div>\n                <h4 class="text-truncate bottom-m-sm" style="max-width: 100%" title="{{fw.name}}">{{fw.name}}</h4>\n              <small translate class="text-muted">Version</small>\n              <p>{{fw.version}}</p>\n            </div>\n\n            <div class="card-actions-group" style="position:static">\n              <button class="btn-flip" ng-click="isFlipped = !isFlipped; toggle(fw)">\n              <i c8y-icon="reply"></i> {{\'Details\' | translate}}\n            </button>\n            </div>\n          </div>\n          <!-- /.card-front -->\n\n          <div class="card card-back bg-gray-lighter" aria-expanded="false" aria-hidden="true">\n            <div class="card-inner-scroll" style="height: calc(100% - 40px)">\n              <form name="firmwareForm" role="form" ng-if="isFlipped" class="card-block">\n                <div class="form-group form-group-sm">\n                  <label translate class="control-label small">Name</label>\n                  <input type="text" class="form-control" ng-model="fw.edited.name" required>\n                </div>\n                <div class="form-group form-group-sm">\n                  <label translate class="control-label small">Version</label>\n                  <input type="text" class="form-control" ng-model="fw.edited.version">\n                </div>\n                <div class="form-group form-group-sm">\n                  <label class="control-label small" translate>File</label>\n                  <c8y-binary-input initial-url="fw.url" set-global="true" output-file="fw.selectedFile" allow-free-url-input="true" file-required="true" c8y-check-dirty="fw.selectedFile.name"></c8y-binary-input>\n                </div>\n                <button class="btn btn-primary btn-block btn-sm" ng-click="save(fw)" ng-disabled="firmwareForm.$invalid || firmwareForm.$pristine" translate>Save</button>\n              </form>\n            </div>\n\n            <div class="card-actions-group">\n              <button type="button" class="btn-flip" ng-click="isFlipped = !isFlipped; toggle(fw)">\n              <i c8y-icon="reply"></i> {{\'Back\' | translate}}\n            </button>\n            </div>\n          </div>\n          <!-- /.card-back -->\n        </div>\n      </div>\n\n    </div>\n    <!-- /.card-flip-container -->\n    <c8y-load-more></c8y-load-more>\n  </div></div>',n.put("core_firmwareList/views/index.html",e),n.put("/apps/core/firmwareList/views/index.html",e)}angular.module("c8y.parts.firmwareList").run(["$templateCache",n])}();