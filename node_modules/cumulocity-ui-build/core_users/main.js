/* core_users 8.21.0 2018-01-30T22:09:56+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";function e(e){e.initUi()}e.$inject=["c8yUsersUiProvider"],angular.module("c8y.users",[]).config(e)}(),function(){"use strict";function e(e,n,t,s){function r(e){return"/users"+(e||"")}function i(){a(),o(),l()}function a(){e.addNavigation({parent:s("Accounts"),name:s("Users"),path:r().replace(/^\//,""),icon:d,priority:5e3,showIfPermissions:{anyRole:m}})}function o(){n.when(g,f),n.when(v,b),n.when(h,b),n.when(h,y)}function l(){t.addTitle(h,w)}function c(e,n){return e.when({title:n.userId})}function u(e,n,t,r,i,a,o,l,c,u,d,p,m){function f(e){return(e.firstName||"")+" "+(e.lastName||"")}function b(e){function n(e){_.forEach(e,function(e){e._expanded=t,n(e._owns)})}var t=e._expanded=!e._expanded;return t||n(e._owns),e}function y(e){return!_.get(e,"owner")||_.get(e,"_owner._expanded")}function w(e){_.forEach(e,function(e){e._expanded=!0})}function A(e){_.forEach(e,function(e){delete e._expanded})}function E(e){return h.replace(/:userId/,encodeURIComponent(e.id))}function R(e){n.path(E(e))}function U(){n.path(g)}function x(n,t){var s={changeGlobalRoles:N,copyInventoryRoles:k,enable:S,disable:C,remove:P,delegate:M,removeDelegate:D},r="string"==typeof t?t:_.get(t,"name"),i=_.get(s,r,e.reject);return i(n,_.get(t,"data"))}function N(e,n){var t=_.map(n.roles,"id");return l.global.updateGroups(e,t)}function k(n){return e.all({copy:c.copyFromUserDialog(n),assignedRoles:o.listInventoryRoles(n)}).then(function(e){var t="replace"===e.copy.process,s=e.copy.roles,r=_.keyBy(e.assignedRoles.data.inventoryAssignments,"managedObject");return u.copyUserRoles(s,r,n,t)})}function C(e){return o.disable(e)}function S(e){return o.enable(e)}function T(e){return _(e._owns).map(function(e){return _.union(T(e),[e])}).flattenDeep().value()}function P(n){var i=n._owns,l=T(n),c=!!l.length,u=function(){return a({title:s("Confirm delete?"),body:r.getString('Do you really want to remove user "{{userName}}"?',n),labels:{ok:s("Delete")},status:"danger"})},d=function e(){var n=l.shift();return n&&o.remove(n).then(e)},p=function(){return t.open({component:"c8yUserRemoveChildrenModal",resolve:{user:_.constant(n)}}).result.then(function(n){var t;if(n.remove&&(t=d()),!_.isUndefined(n.owner)){var s=_.map(i,m(n.owner));t=e.all(_.map(s,function(e){return o.save(e)}))}return t})},m=function(e){return function(n){var t=_.pick(n,["id"]);return t.owner=e,t}},g=c?p():u();return g.then(_.partial(o.remove,n)).then(_.partial(I,n)).then(_.constant({removeUser:!c,refresh:c}))}function I(e){return i.success(r.getString('User "{{userName}}" has been deleted.',e))}function M(e){return o.delegateTo(e).then(_.partial($,e))}function $(e){return i.success(r.getString('You have successfully delegated to user "{{userName}}".',e))}function D(e){var n={id:e.id,delegatedBy:null};return o.save(n).then(_.partial(F,e))}function F(e){return i.success(r.getString('You have successfully removed delegation from user "{{userName}}".',e))}function L(e){return p.hasAnyRole(["ROLE_APPLICATION_MANAGEMENT_READ","ROLE_APPLICATION_MANAGEMENT_ADMIN"],e)}function O(e){return H?G(e)||p.hasRole(e,"ROLE_TENANT_ADMIN"):void 0}function G(e){return H&&H===e.id}var H,V=m();return o.current().then(function(e){H=e.id}),{ROUTE_NEW_USER:v,fullName:f,toggleExpanded:b,createUserFlatTree:d.createUserFlatTree,visibleInList:y,expandAll:w,collapseAll:A,detailLink:E,editUser:R,search:d.search,changeUser:x,getPasswordStrength:V.getStrengthForColor,getPasswordColor:V.getHexColorForColor,getPasswordIcon:V.getIconForColor,isTfaAvailable:o.isTfaAvailable,gotoList:U,userHierarchyActive:d.userHierarchyActive,hasAppManagement:L,isUndeletable:O,isCurrent:G}}c.$inject=["$q","$routeParams"],u.$inject=["$q","$location","$uibModal","gettextCatalog","c8yAlert","c8yModal","c8yUser","c8yRoles","c8yUserRolesUi","c8yUserInventoryRoles","c8yUserUtil","c8yPermissions","passwordStrengthCheckerFactory"];var d="c8y-user",p="c8y-modules",m=["ROLE_USER_MANAGEMENT_READ","ROLE_USER_MANAGEMENT_ADMIN","ROLE_USER_MANAGEMENT_CREATE"],g=r(),v=r("/new"),h=r("/:userId"),f={template:"<c8y-user-list-view></c8y-user-list-view>"},b={priority:1e3,icon:d,name:s("Profile / Global roles"),template:'<c8y-user-detail-view user-id="$resolve.userId"></c8y-user-detail-view>',resolve:{userId:["$route",function(e){return e.current.params.userId}]}},y={priority:-1e3,icon:p,name:s("Application access"),template:'<c8y-user-application-access user="$resolve.user"></c8y-user-application-access>',resolve:{user:["$route","c8yUser","c8yBase",function(e,n,t){return n.detail(e.current.params.userId).then(t.getResData).then(function(e){return e.owner?n.detail(e.owner).then(t.getResData).then(function(n){return e._owner=n,e}):e})}]}},w={data:c};return{initUi:i,$get:u}}e.$inject=["c8yNavigatorProvider","c8yViewsProvider","c8yTitleProvider","gettext"],angular.module("c8y.users").provider("c8yUsersUi",e)}(),function(){"use strict";function e(e,n,t,s,r){function i(){a(),m().then(g)}function a(){e.all([o(U()),u()]).then(function(){return _.forEach(N.users,p)})}function o(e){k=N.users,N.users=[],t.list(e).then(l)}function l(e){c(e),N.users.paging=e.paging}function c(e){var n=N.users,s=n,r=s.paging;_.forEach(e,function(e){var s=_.find(k,{id:e.id});e.twoFactorAuthenticationEnabled||t.isTfaActive(e).then(function(n){n&&(e.twoFactorAuthenticationEnabled=n)}),s&&(e._expanded=s._expanded),_.some(n,{id:e.id})||(n=n.concat([e]))}),n.paging=r,N.users=n}function u(){return r.global.list({pageSize:1e4}).then(d)}function d(e){N.globalRoles=e}function p(e){return e._globalRoles=_.map(_.get(e,"groups.references"),function(e){return _.find(N.globalRoles,{id:e.group.id})}),e}function m(){return s.userHierarchyActive().then(function(e){N.FEATURE_USER_HIERARCHY=e})}function g(){t.current().then(function(e){N.canAddUser=t.hasRole(e,"ROLE_USER_MANAGEMENT_ADMIN")||N.FEATURE_USER_HIERARCHY&&t.hasRole(e,"ROLE_USER_MANAGEMENT_CREATE")})}function v(){N.users.paging.next().then(l)}function h(e){return k=N.users,t.list({owner:e.id,withSubusersCount:!0}).then(c)}function f(e,n){return s.changeUser(e,n).then(_.partial(b,e))}function b(e,n){var s=n||{},r=void 0;if(s.removeUser){var i=_.get(e,"_owner.id");N.users=_.map(_.reject(N.users,{id:e.id}),function(e){return i&&i===e.id?_.omit(e,["$$hashKey"]):e})}return s.refresh||s.removeUser||(r=t.detail(e).then(function(e){var n=e.data,t=n.id;N.users=_.map(N.users,function(e){var s=t===e.id;return s&&(n._expanded=e._expanded),s?p(n):e})})),s.refresh&&(r=o()),r}function y(){return N.FEATURE_USER_HIERARCHY&&_.some(N.users,_.property("_owns.length"))}function w(){s.collapseAll(N.users)}function A(){s.expandAll(N.users),e.all(_.map(N.users,function(n){return n.subusersCount>n._owns.length?h(n).then(function(){return!0}):e.resolve(!1)})).then(function(e){_.some(e)&&n(N.expandAll)})}function E(){o(U())}function R(){N.filters={},o(U())}function U(){var e=_.get(N.filters,"text"),n=_.map(_.get(N.filters,"globalRoles"),"id"),t=n.length?n.join(","):void 0;return{withSubusersCount:!0,username:e,groups:t}}function x(){return _.some(N.filters,_.identity)}var N=this;_.assign(N,{ROUTE_NEW_USER:s.ROUTE_NEW_USER,$onInit:i,loadMore:v,loadSubusers:h,refresh:o,changeUser:f,showExpandCollapse:y,collapseAll:w,expandAll:A,filters:{},loadFilteredUsers:E,clearFilters:R,isAnyFilterSelected:x});var k=void 0}e.$inject=["$q","$timeout","c8yUser","c8yUsersUi","c8yRoles"],angular.module("c8y.users").component("c8yUserListView",{templateUrl:"core_users/userListView/userListView.html",controller:e,controllerAs:"vm"})}(),function(){"use strict";function e(e,n,t,s,r,i,a,o,l,c,u,d,p){function m(){w().then(v),A(),g()}function g(){c.userHierarchyActive().then(function(e){L.FEATURE_USER_HIERARCHY=e})}function v(){V?r.detail(V).then(function(e){return e.data}).then(h):(e.isNew=!0,h({enabled:!0}),S(p("New user")))}function h(n){G=n.email,n.devicePermissions=n.devicePermissions||{},e.user=n,e._groups=f(n),e.password.showPassword=e.isNew,e.isNew&&b()}function f(e){return _.reduce(_.get(e,"groups.references"),function(e,n){return e[n.group.id]=!0,e},{})}function b(){_.forEach(e.groups,function(n){_.includes(B,n.name)&&(e._groups[n.id]=!0)})}function y(n){e.groups=n}function w(e){return i.list(e).then(y)}function A(){return r.current().then(E)}function E(n){e.currentUser=H=n}function R(n){e.isNew||!e.password.showPassword&&!U(n)?k(e.user):l.askForPassword().then(x)}function U(e){return e.email!==G}function x(n){n?k(e.user):N()}function N(){a.danger(p("Current password invalid!")),v()}function k(n){e.saving=!0;var t=_.partial(_.ary(a.success,1),p("User successfully saved")),o=c.gotoList,l=!(n.id&&!n.groups),u=_(e._groups).map(function(e,n){return e&&parseInt(n,10)}).filter().value(),m=l?_.partialRight(i.updateGroups,u):_.identity;try{var g=r.current().then(function(e){return _.isEqual(e.userName,n.userName)});d.isActivatedFor("units-conversion")&&g.then(function(e){e&&C(n),_.unset(n,"measurementUnit")}),g.then(function(){return r.save(_.omit(n,"measurementUnit")).then(s.getResData).then(m).then(t).then(o).finally(function(){e.saving=!1})})}catch(n){a.danger(n.message),e.saving=!1}}function C(e){var n=_.get(e,"measurementUnit.value");u.set("unit",n)}function S(e){e&&o.changeTitle({title:e})}function T(e){return r.hasRole(e,"ROLE_USER_MANAGEMENT_ADMIN")||r.hasRole(e,"ROLE_USER_MANAGEMENT_CREATE")}function P(e,n){return!(!e||!n)&&(!n.id||(e.id===n.id?r.hasRole(e,"ROLE_USER_MANAGEMENT_OWN_ADMIN"):r.hasRole(e,"ROLE_USER_MANAGEMENT_ADMIN")||r.hasRole(e,"ROLE_USER_MANAGEMENT_CREATE")))}function I(e,n){return!(!e||!n)&&e.id!==n.id}function M(){var n=_.get(e.user,"devicePermissions"),t=_.keys(n);return s.getFlag("deprecated")||t.length}function $(n){var t=function(n){O=f(n),_.forEach(e._groups,function(n,t){e._groups[t]=n&&O[t]})};n?r.detail(n).then(s.getResData).then(t):O=null}function D(n){return T(H)&&_.get(e.user,"owner")&&F(n)}function F(n){return _.get(e.user,"owner")&&O&&!O[n.id]}var L=this;_.assign(L,{cancel:c.gotoList});var O,G,H,V=n.userId,B=["business"];e.checkPassword=R,e.$watch("user.userName",S),e.$watch("user.owner",$),e.canEditUser=P,e.canEditUserGroups=T,e.canActivateUser=I,e.forms={},e.password={},e.saving=!1,e.showAcl=M,e.cannotSelectGlobalRole=D,e.restrictedByOwner=F,m()}e.$inject=["$scope","$routeParams","$window","c8yBase","c8yUser","c8yUserGroup","c8yAlert","c8yTitle","c8yUserUtil","c8yUsersUi","c8yUserPreferences","c8yBeta","gettext"],angular.module("c8y.users").component("c8yUserDetailView",{templateUrl:"core_users/userDetailView/userDetailView.html",controller:e,controllerAs:"vm"})}(),function(){"use strict";function e(e,n,t,s,r){function i(e){e.user&&c.user&&a(c.user)}function a(e){t.hasAppManagement(e).then(function(e){c.hasAppManagement=e})}function o(){var n=_.pick(c.user,["id","applications"]);return e.save(n).then(l)}function l(){var e=r("User's application access successfully changed.");return s.success(e)}var c=this;_.assign(c,{save:o,cancel:t.gotoList,$onChanges:i})}e.$inject=["c8yUser","c8yApplication","c8yUsersUi","c8yAlert","gettext"],angular.module("c8y.users").component("c8yUserApplicationAccess",{templateUrl:"core_users/userDetailView/userApplicationAccess.html",bindings:{user:"<"},controller:e,controllerAs:"vm"})}(),function(){"use strict";function e(e,n,t){function s(){r(),i(),a()}function r(){t.isTfaAvailable().then(function(e){b.twoFactorAuthAvailable=e})}function i(){t.userHierarchyActive().then(function(e){b.FEATURE_USER_HIERARCHY=e})}function a(){n.current().then(function(e){b.currentUserId=_.get(e,"id")})}function o(n){n.users&&b.users&&(b.userFlatTree=t.createUserFlatTree(b.users),e.paging=b.users.paging,e.loadNext=function(){return b.onLoadMore()})}function l(e){return _.map(e,"group")}function c(e,n){b.onChangeUser({user:e,action:{name:"changeGlobalRoles",data:{roles:n}}})}function u(e){return function(n){b.onChangeUser({user:n,action:e})}}function d(){return!(!b.searchFilter&&!_.get(b.globalRolesFilter,"length",0))}function p(e){e._expanded||b.onLoadSubusers({user:e}),t.toggleExpanded(e)}function m(e){return!!d()||t.visibleInList(e)}function g(e){return b.FEATURE_USER_HIERARCHY&&b.currentUserId&&e.id!==b.currentUserId}function v(e){return g(e)&&!e.delegatedBy}function h(e){return g(e)&&e.delegatedBy}function f(e){return _.get(e,"_owner._globalRoles",b.globalRoles)}var b=this;_.assign(b,{$onInit:s,$onChanges:o,searchOn:d,fullName:t.fullName,toggleExpanded:p,visible:m,detailLink:t.detailLink,editUser:t.editUser,mapRolesForUser:_.memoize(l),changeGlobalRoles:c,copyInventoryRoles:u("copyInventoryRoles"),disable:u("disable"),enable:u("enable"),remove:u("remove"),delegate:u("delegate"),removeDelegate:u("removeDelegate"),getPasswordStrength:t.getPasswordStrength,getPasswordColor:t.getPasswordColor,getPasswordIcon:t.getPasswordIcon,showDelegate:v,showUndelegate:h,globalRolesAvailable:f,isUndeletable:t.isUndeletable,isCurrent:t.isCurrent})}e.$inject=["$scope","c8yUser","c8yUsersUi"],angular.module("c8y.users").component("c8yUserList",{bindings:{users:"<",globalRoles:"<",searchFilter:"<",globalRolesFilter:"<",onChangeUser:"&",onLoadSubusers:"&",onLoadMore:"&"},templateUrl:"core_users/userList/userList.html",controller:e,controllerAs:"vm"})}(),function(){"use strict";function e(){return{restrict:"EA",scope:{acl:"="},templateUrl:"core_users/aclEditor/aclEditor.html",controller:n}}function n(e,n,t,s,r){function i(){a(),o()}function a(){e.newPermission=e.newPermission||{},e.newPermission.deviceSearch=null,e.newPermission.device=null,e.newPermission.scopeType=null,e.newPermission.type=null,e.newPermission.permissionType=null}function o(){s.current().then(function(n){var t=s.hasRole(n,"ROLE_USER_MANAGEMENT_READ"),r=s.hasRole(n,"ROLE_USER_MANAGEMENT_ADMIN");e.allowView=f=t||r,e.allowEdit=b=r})}function l(e){return e&&null!==e&&""!==e}function c(e){return l(e.device)&&l(e.device.id)&&null!==e.scopeType&&l(e.type)&&null!==e.permissionType}function u(n){var t=n.device.id,s=p(n);e.acl[t]||(e.acl[t]=[]),_.includes(e.acl[t],s)||e.acl[t].push(s),a()}function d(n,t){e.acl[n]=e.acl[n].filter(function(e){return e!==t}),0===e.acl[n].length&&delete e.acl[n]}function p(e){return[e.scopeType.value,e.type,e.permissionType.value].join(":")}function m(e){var n=e.split(":");return[r.getString(n[0]),n[1],r.getString(n[2])].join(":")}function g(e){var n={pageSize:20};return e&&(n.text=e),t.list(n).then(function(e){return v(e)})}function v(e){return _.uniqBy(e,"id")}function h(n){e.newPermission.device=n}var f,b;i(),e.isValidPermission=c,e.add=u,e.remove=d,e.allowView=f,e.allowEdit=b,e.getDevices=g,e.setDevice=h,e.translatePermissionString=m}n.$inject=["$scope","$q","c8yInventory","c8yUser","gettextCatalog"],angular.module("c8y.users").directive("c8yAclEditor",e).directive("aclEditor",e)}(),function(){"use strict";function e(){return{restrict:"EA",scope:{user:"=",allSelected:"=?",allowedApplications:"=",disabledEdit:"=?"},templateUrl:"core_users/applicationAccess/applicationAccess.html",controller:n}}function n(e,n,t){function s(){r()}function r(){i().then(o)}function i(){return n.current().then(t.listByUser).then(a)}function a(e){return _.uniqBy(e,"id")}function o(n){e.applications=n,e.marketApps=_.filter(n,{availability:"MARKET"}),e.privateApps=_.filter(n,{availability:"PRIVATE"})}function l(){e.allowedApplications=e.allowedApplications||[]}function c(e){u(e)?p(e):g(e)}function u(n){return e.allSelected||_.some(e.allowedApplications,m(n))||v(n)}function d(n){return e.allSelected||e.disabledEdit||v(n)||h(n)}function p(n){e.allowedApplications=_.reject(e.allowedApplications,m(n))}function m(e){return function(n){return _.toNumber(e.id)===_.toNumber(n.id)}}function g(n){l(),e.allowedApplications.push({id:n.id,type:n.type})}function v(n){var t,s=n.id,r=e.user;if(r&&!e.allSelected){var i=_(_.get(r,"groups.references")).map("group").map("applications").flatten().uniqBy("id").map("id").value();t=_.includes(i,s)}return t}function h(n){var t=_.get(e,"user._owner.applications");return t&&!v(n)&&!_.some(t,{id:n.id})}e.isAccessAllowed=u,e.toggleAccess=c,e.alreadyInGlobalRole=v,e.isDisabled=d,e.notAvailableInOwner=h,s()}n.$inject=["$scope","c8yUser","c8yApplication"],angular.module("c8y.users").directive("c8yApplicationAccess",e).directive("applicationAccessEditor",e)}(),function(){"use strict";function e(){function e(){var e={};switch(t.solution){case"newOwner":e.owner=t.newOwner;break;case"removeOwner":e.owner=null;break;case"delete":e.remove=!0}return t.close({$value:e})}function n(){return t.solution&&("newOwner"!==t.solution||t.newOwner)}var t=this;_.assign(t,{canConfirm:n,confirm:e,solution:"newOwner"})}angular.module("c8y.users").component("c8yUserRemoveChildrenModal",{templateUrl:"core_users/userRemoveChildren/userRemoveChildren.html",bindings:{close:"&",dismiss:"&",resolve:"<"},controller:e,controllerAs:"vm"})}(),function(){"use strict";function e(e){var n;n='<div class="alert alert-warning">\n  <i c8y-icon="exclamation-triangle" class="fa-2x pull-left"></i>\n  <span translate>\n    This feature is deprecated. Although it\'s still fully functional you should rather use new <a href="/apps/administration#roles">Roles</a> feature to set permissions.\n  </span>\n</div>\n\n<div ng-show="allowEdit && newPermission">\n  <div class="">\n    <div class="form-group">\n      <label>{{\'Managed object\' | translate}} *</label>\n      <input type="text" class="form-control" maxlength="100" ng-model="newPermission.deviceSearch" ng-model-options="{debounce: 300}" placeholder="{{\'Select managed object from list\' | translate}}" uib-typeahead="device.id+\' - \'+device.name for device in getDevices($viewValue)" typeahead-on-select="setDevice($item)" uib-tooltip="{{\'Enter starting fragment of device id or name to search\'| translate}}"/>\n    </div>\n    <c8y-device-permission data-scope="newPermission.scopeType" data-permission-type="newPermission.type" data-access="newPermission.permissionType" data-device="newPermission.device">\n    </c8y-device-permission>\n  </div>\n  <div>\n    <button type="button" class="btn btn-primary" ng-disabled="!isValidPermission(newPermission)" ng-click="add(newPermission)" translate>Add</button>\n  </div>\n</div>\n\n<table class="table table-condensed table-permissions" ng-show="allowView">\n  <thead>\n    <tr>\n      <th translate>Device</th>\n      <th translate>Permissions</th>\n      <th>&nbsp;</th>\n    </tr>\n  </thead>\n  <tbody ng-repeat="(deviceId, permissions) in acl">\n    <tr ng-repeat="permission in permissions track by $index">\n      <td ng-if="$first" style="width: 200px" rowspan="{{permissions.length}}">\n        {{deviceId}}\n      </td>\n      <td>\n        {{translatePermissionString(permission)}}\n      </td>\n      <td class="text-right">\n        <button ng-show="allowEdit" class="btn btn-danger btn-xs showOnHover" title="{{\'Remove permission\' | translate}}" ng-click="remove(deviceId, permission)">\n          <i c8y-icon="times"></i>\n        </button>\n      </td>\n    </tr>\n  </tbody>\n</table>',e.put("core_users/aclEditor/aclEditor.html",n),e.put("/apps/core/users/aclEditor/aclEditor.html",n),n='<div class="card-header" ng-show="marketApps.length">\n  <span class="card-title h4" translate>Built-in applications</span>\n  <a href="" uib-popover-html="\'Applications your tenant<br>is subscribed to\' | translate " popover-append-to-body="true" popover-placement="auto right" popover-trigger="\'focus\'">\n    <i c8y-icon="question-circle-o"></i>\n  </a>\n</div>\n<hr style="margin-top:0; margin-bottom: 0" ng-show="marketApps.length">\n\n<ul class="list-group">\n  <li class="list-group-item item-list-row" ng-repeat="application in marketApps | orderBy:\'name\'">\n    <span style="width:40px" class="text-center">\n      <label class="c8y-checkbox">\n\n      <input type="checkbox" id="{{\'appmarket\' + $index}}" ng-checked="isAccessAllowed(application)" ng-click="toggleAccess(application)" ng-disabled="isDisabled(application)">\n        <span></span>\n    </label>\n    </span>\n    <div class="text-center" style="width:55px">\n      <c8y-app-icon app="::application"></c8y-app-icon>\n    </div>\n    <label for="{{\'appmarket\' + $index}}">\n      {{::application | humanizeAppName}} <br>\n      <small class="text-muted">{{::application.contextPath}}</small>\n    </label>\n    <div style="width:40px" class="text-center">\n      <a href="" ng-show="alreadyInGlobalRole(application)" popover-append-to-body="true" popover-placement="right auto" popover-trigger="\'focus\'" uib-popover="{{\'This application is already made available in a global role\' | translate}}">\n        <i c8y-icon="info-circle"></i>\n      </a>\n      <a href="" class="text-warning" ng-show="notAvailableInOwner(application) && !alreadyInGlobalRole(application)" popover-append-to-body="true" popover-placement="right auto" popover-trigger="\'focus\'" uib-popover="{{\'This application is not accessible by the owner.\' | translate}}">\n          <i c8y-icon="exclamation-circle"></i>\n      </a>\n    </div>\n  </li>\n</ul>\n\n<div class="card-header" ng-show="privateApps.length">\n  <span class="card-title h4" translate>Custom applications</span>\n  <a href="" uib-popover-html="\'Applications owned <br>by your tenant\' | translate" popover-append-to-body="true" popover-placement="right auto" popover-trigger="\'focus\'">\n    <i c8y-icon="question-circle-o"></i>\n  </a>\n</div>\n<hr style="margin-top:0; margin-bottom: 0" ng-show="privateApps.length">\n\n<ul class="list-group" style="margin-bottom:20px">\n  <li class="list-group-item item-list-row" ng-repeat="application in privateApps | orderBy:\'name\'">\n    <span style="width:40px" class="text-center">\n      <label class="c8y-checkbox">\n\n      <input type="checkbox" id="{{\'appprivate\' + $index}}" ng-checked="isAccessAllowed(application)" ng-click="toggleAccess(application)" ng-disabled="isDisabled(application)">\n        <span></span>\n    </label>\n    </span>\n    <div class="text-center" style="width:50px">\n      <c8y-app-icon app="::application"></c8y-app-icon>\n    </div>\n    <label for="{{\'appprivate\' + $index}}">\n      {{::application | humanizeAppName}}<br>\n      <small class="text-muted">{{::application.contextPath}}</small>\n    </label>\n    <div style="width:40px" class="text-center" ng-show="alreadyInGlobalRole(application)">\n      <i c8y-icon="info-circle" class="text-info" popover-append-to-body="true" popover-placement="right auto" popover-trigger="\'focus\'" uib-popover="{{\'This application is already made available in a global role\'}}">\n      </i>\n    </div>\n  </li>\n</ul>',e.put("core_users/applicationAccess/applicationAccess.html",n),e.put("/apps/core/users/applicationAccess/applicationAccess.html",n),n='<c8y-breadcrumbs-set>\n  <c8y-breadcrumbs-item path="#users" label="{{\'Users\' | translate}}" icon="c8y-user"></c8y-breadcrumbs-item>\n</c8y-breadcrumbs-set>\n\n<div class="tab-content-spacer"></div>\n<div class="row">\n  <div class="col-sm-6">\n\n    <p class="alert alert-info" ng-show="vm.hasAppManagement" translate>\n      This user is assigned a global role with \'Application management\' permissions. Therefore all applications are accessible.\n    </p>\n    <div class="card">\n      <c8y-application-access user="vm.user" all-selected="vm.hasAppManagement" allowed-applications="vm.user.applications" disabled-edit="vm.hasAppManagement">\n      </c8y-application-access>\n    </div>\n\n    <div class="text-center page-footer">\n      <c8y-ui-button-footer changed="!vm.hasAppManagement">\n        <button type="button" class="btn btn-default" ng-click="vm.cancel()" translate>\n          Cancel\n        </button>\n        <button type="button" class="btn btn-primary" ng-click="vm.save()" ng-disabled="vm.hasAppManagement" translate>\n          Save\n        </button>\n      </c8y-ui-button-footer>\n    </div>\n\n  </div>\n</div>\n',e.put("core_users/userDetailView/userApplicationAccess.html",n),e.put("/apps/core/users/userDetailView/userApplicationAccess.html",n),n='<c8y-breadcrumbs-set>\n  <c8y-breadcrumbs-item path="#users" label="{{\'Users\' | translate}}" icon="c8y-user"></c8y-breadcrumbs-item>\n</c8y-breadcrumbs-set>\n\n<div class="tab-content-spacer"></div>\n<form name="forms.userForm" role="form" ng-submit="checkPassword(user)" novalidate>\n  <div class="row">\n\n    <div class="col-md-6">\n      <div class="card">\n        <div class="card-header">\n          <h4 class="card-title" translate>Identification</h4>\n        </div>\n        <hr>\n        <div class="card-block">\n          <c8y-ui-edit-user user="user" forms="forms" password="password" disabled-edit="!canEditUser(currentUser, user)" hide-active="!canActivateUser(currentUser, user)" hide-owner="!vm.FEATURE_USER_HIERARCHY" hide-delegate="!vm.FEATURE_USER_HIERARCHY" hide-language="true">\n          </c8y-ui-edit-user>\n        </div>\n      </div>\n    </div>\n\n    <div class="col-md-6">\n      <div class="card">\n        <div class="card-header">\n          <h4 class="card-title" translate>Global roles</h4>\n        </div>\n        <hr>\n        <ul class="list-group">\n          <li class="list-group-item item-list-row" ng-repeat="group in groups">\n            <label class="c8y-checkbox text-center" style="width:40px">\n              <input type="checkbox" id="{{\'groupcheckbox\' + $index}}" ng-model="_groups[group.id]" ng-disabled="!canEditUserGroups(currentUser) || restrictedByOwner(group)">\n                <span></span>\n            </label>\n            <label for="{{\'groupcheckbox\' + $index}}">\n              {{::group.name | translate}}\n              <a href="" class="pull-right text-info" ng-show="restrictedByOwner(group)" popover-append-to-body="true" popover-trigger="\'focus mouseenter\'" popover-placement="auto" uib-popover="{{\'Only global roles defined on the owner can be defined on the owned user\' | translate}}">\n                <i c8y-icon="exclamation-circle"></i>\n              </a>\n              <br><small class="text-muted">{{::group.description | translate}}</small>\n            </label>\n          </li>\n        </ul>\n\n        <div ng-show="showAcl()">\n          <div class="card-header">\n            <h4 translate>User permissions</h4>\n          </div>\n          <div class="card-block">\n            <c8y-acl-editor acl="user.devicePermissions"></c8y-acl-editor>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n\n  <div class="text-center page-footer">\n    <c8y-ui-button-footer changed="forms.userForm.$dirty">\n      <button type="button" ng-click="vm.cancel()" class="btn btn-default" translate>\n        Cancel\n      </button>\n      <button ng-if="canEditUser(currentUser, user)" ng-class="{\'btn-save\': showPassword}" class="btn btn-primary" type="submit" ng-disabled="forms.userForm.$invalid || saving || !forms.userForm.$dirty" translate>\n        Save\n      </button>\n    </c8y-ui-button-footer>\n  </div>\n</form>',e.put("core_users/userDetailView/userDetailView.html",n),e.put("/apps/core/users/userDetailView/userDetailView.html",n),n='<div class="user-list-header user-list-row">\n  <div class="col-expand"></div>\n  <!-- <div class="col-selector"></div> -->\n  <label class="col-username" translate>User name</label>\n  <label class="col-subaccounts"></label>\n  <label class="col-fullname" translate>Name and email</label>\n  <label class="col-globalroles" translate>Global roles</label>\n  <label class="col-passwordstrength" translate style="flex:0 0 92px">Pass strength</label>\n  <div class="col-actions"></div>\n</div>\n\n<div class="user-list-row" ng-repeat="user in vm.userFlatTree | filter:vm.visible" ng-class="::{owned: !!user.owner, owns: user.subusersCount > 0}" ng-style="{\'margin-left\': (user._depth * 10), \'margin-right\': (user._depth * 10) }">\n\n  <div class="col-expand interact" ng-style="{width: 30 - user._depth * 10}" ng-click="::!vm.searchOn() && vm.toggleExpanded(user)" ng-show="::user.subusersCount">\n    <span translate class="hidden-md hidden-lg">Subaccounts</span>\n    <span class="badge bg-primary hidden-md hidden-lg">{{user.subusersCount}}</span>\n    <i c8y-icon="chevron-down" ng-class="{\'open\':user._expanded}" ng-hide="vm.searchOn()"></i>\n  </div>\n  <div class="col-expand" ng-style="{width: 30 - user._depth * 10}" ng-hide="::user.subusersCount">\n  </div>\n\n  <div class="col-username interact text-truncate" ng-click="vm.editUser(user)">\n    <div class="user-dot" ng-class="{\'user-disabled\': !user.enabled}">{{::user.userName.substr(0,2)}}</div>\n    <span class="username text-truncate">\n      <span title="{{::user.userName}}" class="h4">{{::user.userName}}</span>\n      <br ng-hide="::user.enabled"><small class="disabled" ng-hide="::user.enabled" translate>Disabled</small>\n      <br ng-show="::user.delegatedBy"><small class="delegated text-primary" ng-show="::user.delegatedBy" translate>Delegated by {{::user.delegatedBy}}</small>\n    </span>\n\n  </div>\n\n  <div class="col-subaccounts text-center">\n    <a href="" ng-show="user.subusersCount" uib-tooltip="{{\'Subaccounts\' | translate}}" ng-show="vm.USER_HIERARCHY">\n      <span class="badge bg-primary">{{user.subusersCount}}</span>\n    </a>\n  </div>\n\n  <div class="col-fullname interact text-truncate" ng-click="vm.editUser(user)">\n    {{::vm.fullName(user)}}\n    <br><small>{{::user.email}}</small>\n  </div>\n\n\n  <div class="col-globalroles">\n    <c8y-item-selector items="vm.globalRolesAvailable(user)" items-selected="::vm.mapRolesForUser(user.groups.references)" on-apply="vm.changeGlobalRoles(user, items)" text-apply="{{\'Apply\' | translate}}" text-placeholder="{{\'----\'}}" style-button="{background: \'transparent\', padding: 5, \'padding-right\': 40}">\n    </c8y-item-selector>\n  </div>\n\n  <!-- Password strength -->\n  <div class="col-passwordstrength">\n    <span ng-if="user.passwordStrength" class="text-truncate" title="{{::vm.getPasswordStrength(user.passwordStrength) | translate}}" ng-style="{color: vm.getPasswordColor(user.passwordStrength)}">\n      <i c8y-icon="{{::vm.getPasswordIcon(user.passwordStrength)}}"></i>\n      {{::vm.getPasswordStrength(user.passwordStrength) | translate}}\n    </span>\n  </div>\n\n  <div class="col-twofactorauth text-right">\n    <i class="text-success" ng-show="user.twoFactorAuthenticationEnabled" uib-tooltip="{{\'TFA enabled\'}}" c8y-icon="key">\n    </i>\n  </div>\n\n  <div class="col-actions">\n    <div class="dropdown" uib-dropdown dropdown-append-to-body>\n      <a class="dropdown-toggle c8y-dropdown" uib-dropdown-toggle ng-click="::$event.stopPropagation()">\n        <span><i c8y-icon="ellipsis-v"></i></span>\n      </a>\n      <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>\n        <li>\n          <a ng-href="#{{::vm.detailLink(user)}}">\n            <i c8y-icon="edit"></i> <translate>Edit</translate>\n          </a>\n        </li>\n        <li ng-hide="vm.isCurrent(user)">\n          <a href="" ng-click="vm.copyInventoryRoles(user)">\n            <i c8y-icon="clipboard"></i> <translate>Copy inventory roles from...</translate>\n          </a>\n        </li>\n        <li ng-show="::vm.showDelegate(user)">\n         <a href="" ng-click="vm.delegate(user)">\n           <i c8y-icon="universal-access"></i> <translate>Delegate</translate>\n         </a>\n       </li>\n       <li ng-show="::vm.showUndelegate(user)">\n         <a href="" ng-click="vm.removeDelegate(user)">\n           <i c8y-icon="universal-access"></i> <translate>Undelegate</translate>\n         </a>\n       </li>\n        <li ng-show="user.enabled && !vm.isCurrent(user)">\n          <a href="" ng-click="vm.disable(user)">\n            <i c8y-icon="ban"></i> <translate>Disable</translate>\n          </a>\n        </li>\n        <li ng-hide="::(user.enabled)">\n          <a href="" ng-click="vm.enable(user)">\n            <i c8y-icon="check-circle-o"></i> <translate>Enable</translate>\n          </a>\n        </li>\n        <li>\n          <a href="" ng-click="vm.remove(user)" ng-hide="::vm.isUndeletable(user)">\n            <i c8y-icon="user-times"></i> <translate>Delete</translate>\n          </a>\n        </li>\n      </ul>\n    </div>\n  </div>\n  <div class="tip" ng-class="{\'expanded\': user._expanded}"></div>\n</div>\n\n<c8y-load-more></c8y-load-more>\n',
e.put("core_users/userList/userList.html",n),e.put("/apps/core/users/userList/userList.html",n),n='<c8y-ui-title-set title="\'Users\' | translate"></c8y-ui-title-set>\n\n<c8y-ui-action-bar-set>\n  <li class="navbar-form" action-bar-position="left">\n    <div class="input-group input-group-search">\n      <input class="form-control" type="search" ng-model="vm.filters.text" placeholder="{{\'Filter users\' | translate}}">\n      <span class="input-group-addon">\n        <i c8y-icon="search"></i>\n      </span>\n    </div>\n  </li>\n\n  <li class="navbar-form" action-bar-position="left">\n    <c8y-item-selector style="max-width:220px" items="::vm.globalRoles" items-selected="vm.filters.globalRoles" on-apply="vm.filters.globalRoles=items" text-apply="{{\'Done\' | translate}}" text-placeholder="{{\'Filter by global roles\' | translate}}" style-button="{padding: 5, \'padding-right\': 40, border:\'2px solid #E5E7E7\'}">\n    </c8y-item-selector>\n  </li>\n\n  <li class="navbar-form" action-bar-position="left">\n    <button type="button" style="display: inline-block; width: auto" title="{{\'Apply filters\' | translate}}" class="btn btn-link" ng-click="vm.loadFilteredUsers()">\n      <i c8y-icon="filter"></i>\n      <translate>Filter</translate>\n    </button>\n\n    <button type="button" style="display: inline-block; width: auto" title="{{\'Clear filters\' | translate}}" class="btn btn-link" ng-click="vm.clearFilters()" ng-show="vm.isAnyFilterSelected()">\n      <i c8y-icon="times"></i>\n    </button>\n  </li>\n\n  <button type="button" class="btn btn-link" ng-click="vm.expandAll()" ng-show="vm.showExpandCollapse()">\n    <i c8y-icon="window-maximize"></i> {{\'Expand all\' | translate}}\n  </button>\n\n  <button type="button" class="btn btn-link" ng-click="vm.collapseAll()" ng-show="vm.showExpandCollapse()">\n    <i c8y-icon="minus"></i> {{\'Collapse all\' | translate}}\n  </button>\n\n  <li ng-show="vm.canAddUser">\n    <a href="#{{vm.ROUTE_NEW_USER}}" class="btn btn-link">\n      <i c8y-icon="user-plus"></i> {{\'Add user\' | translate}}\n    </a>\n  </li>\n\n  <button type="button" class="btn btn-link" ng-click="vm.refresh()">\n    <i c8y-icon="refresh"></i> {{\'Reload\' | translate}}\n  </button>\n</c8y-ui-action-bar-set>\n\n<c8y-bulk-actions actions="vm.bulkActions" list="vm.users" on-complete="vm.refresh()">\n</c8y-bulk-actions>\n\n<c8y-user-list users="vm.users" global-roles="::vm.globalRoles" on-load-subusers="vm.loadSubusers(user)" on-load-more="vm.loadMore()" on-change-user="vm.changeUser(user, action)">\n</c8y-user-list>\n',e.put("core_users/userListView/userListView.html",n),e.put("/apps/core/users/userListView/userListView.html",n),n='<div class="modal-header">\n  <h3>\n    <i c8y-icon="{{vm.titleIcon}}"></i>\n    <span>{{\'Confirm delete?\' | translate}}</span>\n  </h3>\n</div>\n\n<p class="text-center" style="padding:10px" translate>\n  <b>You are about to delete user ""{{vm.resolve.user.userName}}"</b>\n  <br>How should subusers be handled?</p>\n<p></p>\n\n<div class="text-center" style="margin-bottom:20px">\n  <label class="radio-inline">\n    <input type="radio" ng-model="vm.solution" value="newOwner"> {{\'Select a new owner\' | translate}}\n  </label>\n  <label class="radio-inline">\n    <input type="radio" ng-model="vm.solution" value="removeOwner"> {{\'Remove owner\' | translate}}\n  </label>\n  <label class="radio-inline">\n    <input type="radio" ng-model="vm.solution" value="delete"> {{\'Delete all subusers\' | translate}}\n  </label>\n</div>\n\n<c8y-ui-user-picker ng-show="vm.solution===\'newOwner\'" hidden-users="vm.resolve.user" ng-model="vm.newOwner">\n</c8y-ui-user-picker>\n\n<div class="modal-footer">\n  <button class="btn btn-primary" ng-disabled="!vm.canConfirm()" ng-click="vm.confirm()" translate>\n    Confirm\n    </button>\n\n  <button class="btn btn-default" ng-click="vm.dismiss()" translate>Cancel</button>\n</div>\n',e.put("core_users/userRemoveChildren/userRemoveChildren.html",n),e.put("/apps/core/users/userRemoveChildren/userRemoveChildren.html",n)}angular.module("c8y.users").run(["$templateCache",e])}();