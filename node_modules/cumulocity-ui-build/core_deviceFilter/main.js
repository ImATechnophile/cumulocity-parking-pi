/* core_deviceFilter 8.21.0 2018-01-30T22:08:27+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
angular.module("c8y.parts.deviceFilter",[]),angular.module("c8y.parts.deviceFilter").controller("deviceFilterVPCtrl",["$scope","$location","$routeParams","c8yDeviceGroup","c8yIdentity","gettext","gettextCatalog",function(e,t,n,a,r,i,l){"use strict";function s(){a.list().then(function(t){var a=t.data,r=e.groupsOptions.data=a.managedObjects;if(n.group){var i=r.filter(function(e){return parseInt(e.id,10)===parseInt(n.group,10)});i.length&&(e.groupToFilter={id:i[0].id,text:i[0].name})}})}function c(){n.eidType&&n.eid&&(e.externalId=n.eid,e.type=n.eidType,e.search()),n.text&&(e.searchString=n.text),n.text&&(e.hasFilters=!0)}e.groupsOptions={data:[],query:function(t){var n={results:[]};_.isUndefined(t.term)||(e.groupsOptions.data.forEach(function(e){var a=0===t.term.length||e.name.toUpperCase().indexOf(t.term.toUpperCase())>=0;a&&n.results.push({id:e.id,text:e.name})}),t.callback(n))}},s(),e.$watch("groupToFilter",function(e){e&&e.id&&t.url("device?group="+e.id)}),e.clear=function(){t.url("device")},e.search=function(){var n={externalId:e.externalId,type:e.type};r.getExternalId(n).then(function(e){var n=e.data.managedObject.id;t.url("device/"+n)},function(){e.$emit("message",{type:"error",text:i("Device not found")})})},e.freeSearch=function(e){t.url("device?text="+e)},c()}]),function(){"use strict";function e(e){var t;t='<div class="form-inline" data-ng-controller="deviceFilterVPCtrl" style="margin-bottom:30px">\n  <div class="pull-right" style="margin-left:20px">\n    <label translate>Text Search</label><br>\n    <form class="form-inline" data-ng-submit="freeSearch(searchString)">\n      <div class="input-append">\n        <input type="search" data-ng-model="searchString" placeholder="{{\'Search\' | translate }}">\n        <button class="btn" type="submit"><i class="icon-search"></i></button>\n      </div>\n       <button class="btn btn-inverse" title="{{\'Clear filter\' | translate}}" data-ng-show="hasFilters" data-ng-click="clear()"><i class="icon-remove-sign"></i></button>\n    </form>\n  </div>\n\n  <div class="pull-right">\n  <label translate>Find by external ID</label><br>\n  <form class="form-inline" data-ng-submit="search()">\n    <div class="input-prepend">\n      <span class="add-on" translate>Type:</span>\n      <input class="input-small" type="text" data-ng-model="type" placeholder="{{\'ex.: serial\' | translate}}">\n    </div>\n    <div class="input-prepend input-append">\n      <span class="add-on" translate>Id:</span>\n      <input type="text" data-ng-model="externalId" placeholder="">\n      <button class="btn" type="submit"><i class="icon-search"></i></button>\n    </div>\n  </form>\n  </div>\n\n  <label translate>Filter devices by group</label><br>\n   <input data-ui-select2="groupsOptions" data-ng-model="groupToFilter" data-ng-change="changeGroup(currentDeviceGroups)" data-placeholder="{{\'Group name\' | translate}}" type="hidden" style="width:200px">\n   <button class="btn btn-inverse" title="{{\'Clear filter\' | translate}}" data-ng-show="groupToFilter" data-ng-click="clear()"><i class="icon-remove-sign"></i></button>\n\n\n</div>\n',e.put("core_deviceFilter/views/index.html",t),e.put("/apps/core/deviceFilter/views/index.html",t)}angular.module("c8y.parts.deviceFilter").run(["$templateCache",e])}();