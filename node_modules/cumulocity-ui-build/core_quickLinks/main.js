/* core_quickLinks 8.21.0 2018-01-30T22:09:20+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";function n(n,e){n.add({name:"Quick links",description:e("Displays a panel with quick links"),templateUrl:"core_quickLinks/views/component.html",options:{noDeviceTarget:!0}})}n.$inject=["c8yComponentsProvider","gettext"],angular.module("c8y.welcome.quickLinks",[]).config(n)}(),function(){"use strict";function n(n,e,i,t,c,r,o,l,s){function a(){u().then(p).then(v).then(k).then(m)}function u(){return c.getCurrent().then(d)}function d(n){R=n.name}function p(){return c.listByUser().then(g)}function g(n){N=_(n).map(function(n){return n.contextPath}).uniq().value()}function v(){return t.getCount()}function k(n){n=parseInt(n);var i=[],c=h(),r=C(),o=b(),l=A(),s=q(),a=x();if(0===n)r.priority=1;else if(n<=5){var u=1===n?1:3;i.push(t.list({pageSize:n}).then(function(n){var e=[];return _.forEach(n,function(n){e.push(E(n,{priority:u}))}),e}))}else s.priority=1;return i.push(f()),i.push(e.when(c)),i.push(e.when(r)),i.push(e.when(o)),"devicemanagement"!==R&&i.push(e.when(l)),"cockpit"!==R&&i.push(e.when(s)),a&&"HelpAndService"!==R&&i.push(e.when(a)),e.all(i).then(_.flattenDeep).then(_.partialRight(_.filter,function(n){return n}))}function m(n){D.length=0,_.forEach(n,function(n){D.push(n)})}function f(){var n=i.getPluginService("phoneRegistrationService");if(n)return n.createAddPhoneLink()}function h(n){return y().then(function(e){return e?_.assign({priority:2,icon:"c8y-icon c8y-icon-add-user",label:l("Add user"),url:"/apps/administration/index.html#/users/new",color:"#FEFEFE",backgroundColorClass:"a"},n):null})}function y(){var n=["ROLE_USER_MANAGEMENT_CREATE","ROLE_USER_MANAGEMENT_ADMIN"];return s.hasAnyRole(n).then(function(n){return n&&S("administration")})}function C(n){if(S("devicemanagement"))return _.assign({priority:2,icon:"c8y-icon c8y-icon-device-connect",label:l("Add device"),url:"",click:F,color:"#FEFEFE",backgroundColorClass:"b"},n)}function b(n){var e={dt:{backgroundColorClass:"d"}};if(S("devicemanagement"))return _.assign({priority:2,icon:"c8y-icon c8y-icon-group-add",label:l("Add group"),url:"",click:w,color:"#FEFEFE",backgroundColorClass:(e[P]||{}).backgroundColorClass||"e"},n)}function E(n,e){var i={dt:{priority:2}};if(S("cockpit"))return _.assign({priority:(i[P]||{}).priority||3,icon:"c8y-icon c8y-icon-device",label:n.name||l("Device ")+n.id,url:"/apps/cockpit/index.html#/device/"+n.id,color:"#FEFEFE",backgroundColorClass:"c"},e)}function w(){o.addAssetUI()}function F(){r({templateUrl:"core_quickLinks/views/deviceRegistration.html",controller:"deviceRegistrationCtrl"})}function A(n){var e={dt:{priority:2}};if(S("devicemanagement")){var i="/apps/devicemanagement";return _.assign({priority:(e[P]||{}).priority||3,icon:"c8y-icon c8y-icon-device-management",label:l("Device management"),url:i,color:"#EFEFEF",backgroundColorClass:"f"},n)}}function q(n){var e={dt:{priority:2}};if(S("cockpit")){var i="/apps/cockpit";return _.assign({priority:(e[P]||{}).priority||3,icon:"c8y-icon c8y-icon-cockpit",label:l("Cockpit"),url:i,color:"#EFEFEF",backgroundColorClass:"e"},n)}}function x(n){if("dt"===P&&S("HelpAndService")){var e="/apps/HelpAndService";return _.assign({priority:2,iconSrc:"core_quickLinks/icons/HelpAndService.svg",label:l("Help & Service"),url:e,color:"#EFEFEF",backgroundColorClass:"f"},n)}}function S(n){return _.includes(N,n)}function L(n){return["quick-link","quick-link-"+n.priority,"quick-link-bgcolor-"+n.backgroundColorClass]}var R,D=[],N=[],P=({1:["col-lg-4","col-md-3","col-sm-4","col-xs-6"].join(" "),2:["col-lg-3","col-md-3","col-sm-4","col-xs-6"].join(" "),3:["col-lg-2","col-md-2","col-sm-4","col-xs-6"].join(" ")},_.merge({},window.C8Y_APP&&window.C8Y_APP.C8Y_INSTANCE_OPTIONS,window.C8Y_INSTANCE_OPTIONS).target);n.links=D,n.getLinkClass=L,a()}n.$inject=["$scope","$q","c8yBase","c8yDevices","c8yApplication","c8yModal","groupsHierarchySvc","gettext","c8yPermissions"],angular.module("c8y.welcome.quickLinks").controller("QuickLinksController",n)}(),function(){"use strict";function n(n,e,i,t,c,r,o){function l(n){var i=o.getString("Device {{id}} is successfully registered.",n);return t.create(n).then(_.partial(_.unary(c.success),i)).then(e.close)}n.newDevice={},n.title=r("Create device"),n.validation=i.validation,n.register=l,n.dismiss=e.dismiss}n.$inject=["$scope","$uibModalInstance","c8yConfig","c8yDeviceRegistration","c8yAlert","gettext","gettextCatalog"],angular.module("c8y.welcome.quickLinks").controller("deviceRegistrationCtrl",n)}(),function(){"use strict";function n(n){var e;e='<div class="card-group-block interact-grid quicklinks" style="margin-bottom:0" ng-controller="QuickLinksController">\n  <a ng-href="{{link.url}}" ng-click="link.click()" ng-class="getLinkClass(link)" class="card text-center flex-center flex-col" ng-repeat="link in links | orderBy:\'priority\'" style="min-height: 230px">\n    <div class="card-block flex-item-v-center text-white">\n      <h1 style="font-size: 68px">\n        <i ng-show="link.icon" class="{{link.icon}}"></i>\n        <img ng-show="link.iconSrc" ng-src="{{link.iconSrc}}" class="img-responsive center-block" style="max-width: 102px">\n      </h1>\n      <p class="text-truncate">{{link.label | translate}}</p>\n    </div>\n  </a>\n</div>\n',n.put("core_quickLinks/views/component.html",e),n.put("/apps/core/quickLinks/views/component.html",e),e='<div class="modal-header" ng-show="title">\n  <h3 ng-bind="title | translate"></h3>\n</div>\n<div class="modal-body">\n  <form name="deviceRegistrationForm" role="form" novalidate>\n    <div class="form-group">\n      <input id="id" name="id" type="text" class="form-control" placeholder="{{\'Device ID\' | translate}}" ng-model="newDevice.id" c8y-autocomplete="off" autocorrect="off" autocapitalize="off" c8y-validate-url-segment required>\n      <c8y-error-feedback field="deviceRegistrationForm.id">\n        <span ng-message="required" translate>Device ID is required.</span>\n      </c8y-error-feedback>\n    </div>\n  </form>\n</div>\n<div class="modal-footer">\n  <button class="btn btn-primary" ng-disabled="deviceRegistrationForm.$invalid" ng-click="register(newDevice)" translate>\n    Create\n  </button>\n  <button class="btn btn-default" ng-click="dismiss()" translate>\n    Close\n  </button>\n</div>\n',n.put("core_quickLinks/views/deviceRegistration.html",e),n.put("/apps/core/quickLinks/views/deviceRegistration.html",e)}angular.module("c8y.welcome.quickLinks").run(["$templateCache",n])}();