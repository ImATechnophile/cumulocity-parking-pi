/* core_configurationRepository 9.3.0 2018-03-26T16:24:39+00:00 796b68a031b1+ (release/9.3.0) tip */
!function(){"use strict";function n(n,e,t){n.addNavigation({parent:t("Management"),name:t("Configuration repository"),priority:1e3,path:"configuration",icon:"gears"}),e.when("/configuration",{templateUrl:"core_configurationRepository/views/list.html"})}angular.module("c8y.configurationRepository",[]).config(["c8yNavigatorProvider","c8yViewsProvider","gettext",n])}(),function(){"use strict";function n(n,e,t,i,o,a,r,l,c,s,d){function u(){p(),g()}function g(){i.add&&t(function(){$(q).click()})}function f(n){var e=n.then(function(n){return{title:s("Configuration snapshots repository"),subtitle:!_.isUndefined(n)&&n>0?d.getPlural(n,"1 snapshot","{{qty}} snapshots",{qty:n}):""}});r.changeTitle(e)}function p(n){return c.list(n).then(m)}function m(t){n.configurations&&!n.refreshLoading||(n.configurations=[]),n.paging=t.paging,t.forEach(function(e){n.configurations.push(e),e.id===i.id&&R.push(e)}),f(e.when(t.length))}function v(){n.paging.loading=!0,n.paging.next().then(m).finally(function(){n.paging.loading=!1})}function y(){n.refreshLoading=!0,n.paging.refresh().then(m).finally(function(){n.refreshLoading=!1})}function b(n){return R.indexOf(n)}function h(n){return b(n)>-1}function w(n){h(n)?R.splice(b(n),1):R.push(n)}function x(t){l({title:s("Confirm delete?"),body:d.getString('Do you really want to remove "{{name}}" configuration?',t),status:"danger",labels:{ok:s("Delete")},size:"sm"}).then(angular.bind(c,c.remove,t)).then(angular.bind(a,a.removeFromList,n.configurations,t)).then(function(){o.success(s("Configuration successfully removed.")),f(e.when(n.configurations.length))})}function C(n){c.save(n).then(angular.bind({},y)).finally(F)}function k(){E.newCfg=c.getEmpty(),E.newCfg.deviceType=i.type}function F(){$(q).attr("aria-expanded","false"),E.dropdownOpen=!1,E.newCfg=null}function T(n){return _.cloneDeep(n)}function D(n){n&&(E.newCfgForm.$setPristine(),E.newCfgForm.$setUntouched())}var E=this,R=[],q="#add-configuration-snapshot-btn";n.onToggle=D,n.loadNext=v,n.refresh=y,n.toggle=w,n.isOpen=h,n.onClickDelete=x,n.save=C,n.add=k,n.cancelAdd=F,n.invalid=angular.bind(a,a.invalid,n),n.getConfigurationsCopy=T,n.status={isOpen:!1},u()}n.$inject=["$scope","$q","$timeout","$routeParams","c8yAlert","c8yBase","c8yTitle","c8yModal","configurationRepositorySvc","gettext","gettextCatalog"],angular.module("c8y.configurationRepository").controller("configurationRepositoryListCtrl",n)}(),function(){"use strict";function n(n,e,t,i,o){function a(){var n={name:"",description:"",url:"",type:g};return n}function r(n){var t=l(n);return e.list(t)}function l(n){return _.assign({type:g},n||{})}function c(t){return t.type=g,n.when(t).then(_.partialRight(e.addGlobalFlag,!0)).then(s).then(d).then(e.save).then(function(){i.success(o("Configuration snapshot is successfully added."))})}function s(e){var i=t.getIdFromUrl(e.selectedFile.url),o=i?t.setGlobalFlag(i,!0):n.when();return o.then(_.constant(e))}function d(e){return e.selectedFile.url&&(e.url=e.selectedFile.url,delete e.selectedFile),n.when(e)}function u(n){return e.remove(n)}var g="c8y_ConfigurationDump";return{getEmpty:a,list:r,save:c,remove:u}}n.$inject=["$q","c8yInventory","c8yBinary","c8yAlert","gettext"],angular.module("c8y.configurationRepository").factory("configurationRepositorySvc",n)}(),function(){"use strict";function n(n){var e;e='<div ng-controller="configurationRepositoryListCtrl as vm">\n  <c8y-ui-action-bar-set>\n    <div class="dropdown" on-toggle="onToggle(open)" uib-dropdown auto-close="outsideClick" is-open="vm.dropdownOpen">\n      <button class="dropdown-toggle c8y-dropdown" id="add-configuration-snapshot-btn" uib-dropdown-toggle aria-haspopup="true" aria-expanded="false" ng-click="add()">\n        <span><i c8y-icon="plus-square"></i> <translate>Add configuration snapshot</translate></span>\n      </button>\n      <ul class="dropdown-menu dropdown-menu-right" uib-dropdown-menu>\n        <li class="dropdown-form">\n          <form role="form" name="vm.newCfgForm" class="panel-body" novalidate>\n            <div class="form-group">\n              <label translate>Name</label>\n              <input type="text" class="form-control" ng-model="vm.newCfg.name" ng-maxlength="60" name="name" required>\n              <c8y-error-feedback field="vm.newCfgForm.name"></c8y-error-feedback>\n            </div>\n            <div class="form-group">\n              <label translate>Description</label>\n              <input type="text" class="form-control" name="description" ng-model="vm.newCfg.description" ng-maxlength="200">\n              <c8y-error-feedback field="vm.newCfgForm.description"></c8y-error-feedback>\n            </div>\n            <div class="form-group">\n              <label>\n                <span translate>Device type</span>\n                <button class="btn btn-clean text-primary" uib-popover="{{\'The device type can be found in the device information tab of the target device.\' | translate}}" popover-append-to-body="true" popover-trigger="\'focus\'">\n                  <i c8y-icon="question-circle-o"></i>\n                </button>\n              </label>\n              <input ng-model="vm.newCfg.deviceType" type="text" class="form-control" placeholder="{{\'e.g.: c8y_OBU-GT\' | translate}}">\n            </div>\n            <div class="form-group">\n              <label translate>Configuration snapshot file</label>\n              <c8y-binary-input initial-url="vm.newCfg.url" output-file="vm.newCfg.selectedFile" allow-free-url-input="true" file-required="true"></c8y-binary-input>\n            </div>\n            <button class="btn btn-primary" ng-click="save(vm.newCfg)" ng-disabled="vm.newCfgForm.$invalid" translate>Add configuration snapshot\n                    </button>\n          </form>\n        </li>\n      </ul>\n    </div>\n\n\n    <c8y-refresh-btn></c8y-refresh-btn>\n  </c8y-ui-action-bar-set>\n\n\n  <div class="c8y-empty-state text-center" ng-show="configurations.length == 0">\n    <h1 c8y-icon="gears"></h1>\n    <h3 translate>There are no configuration snapshots defined</h3>\n    <p translate>Add your first configuration snapshot using the button on the toolbar.</p>\n    <p c8y-guide-docs><small translate>Find out more on the <a c8y-guide-href="users-guide/device-management/#configsnap">User Guide</a>.</small></p>\n  </div>\n\n  <div class="list-group">\n    <div ng-repeat="cfg in configurations | orderBy:\'name\'" class="list-group-item flex-row collapsible" ng-class="{\'expanded\': isDetailExpanded}">\n      <div class="list-item-actions">\n        <button type="button" title="{{\'Expand\' | translate}}" class="collapse-btn" ng-click="isDetailExpanded = !isDetailExpanded">\n          <i c8y-icon="chevron-down"></i>\n        </button>\n      </div>\n\n      <div class="list-item-body" ng-click="isDetailExpanded = !isDetailExpanded">\n        <div class="row">\n          <div class="col-sm-10 col-xs-12">\n            <span ng-click="isDetailExpanded = !isDetailExpanded">{{cfg.name}}</span>\n            <small class="text-muted" ng-bind="cfg.description"></small>\n          </div>\n          <div class="col-sm-2 text-right showOnHover hidden-xs">\n            <button class="btn btn-danger btn-xs" ng-click="onClickDelete(cfg)" title="{{\'Delete\' | translate}}">\n              <i c8y-icon="trash"></i>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div class="collapse" uib-collapse="!isDetailExpanded" data-ng-init="cfgToEdit = getConfigurationsCopy(cfg)">\n        <form role="form" name="cfgForm" class="top-m bottom-m" novalidate>\n          <div class="row">\n            <div class="col-lg-3">\n              <div class="form-group">\n                <label>{{\'Name\' | translate}}</label>\n                <input type="text" class="form-control" name="name" ng-model="cfgToEdit.name" required ng-maxlength="60">\n                <c8y-error-feedback field="cfgForm.name"></c8y-error-feedback>\n              </div>\n            </div>\n            <div class="col-lg-3">\n              <div class="form-group">\n                <label>{{\'Description\' | translate}}</label>\n                <input type="text" class="form-control" name="description" ng-model="cfgToEdit.description" ng-maxlength="200">\n                <c8y-error-feedback field="cfgForm.description"></c8y-error-feedback>\n              </div>\n            </div>\n            <div class="col-lg-3">\n              <div class="form-group">\n                <label for="deviceType">{{\'Device type\' | translate}} \n                  <a href="" uib-popover="{{\'The device type can be found in the device information tab of the target device.\' | translate}}" popover-trigger="\'focus\'" popover-placement="right" popover-append-to-body="true">\n                    <i c8y-icon="question-circle-o"></i>\n                  </a>\n                </label>\n                <input id="deviceType" name="deviceType" ng-model="cfgToEdit.deviceType" type="text" class="form-control" placeholder="{{\'e.g.: c8y_OBU-GT\' | translate}}">\n              </div>\n            </div>\n            <div class="col-lg-3">\n              <div class="form-group">\n                <label>{{\'Configuration snapshot file\' | translate}}</label>\n                <c8y-binary-input initial-url="cfg.url" output-file="cfgToEdit.selectedFile" allow-free-url-input="true" file-required="true" c8y-check-dirty="cfgToEdit.selectedFile.name"></c8y-binary-input>\n              </div>\n            </div>\n          </div>\n          <button class="btn btn-danger visible-xs-inline-block" ng-click="onClickDelete(cfgToEdit)">\n            <i c8y-icon="trash"></i> {{\'Delete\' | translate}}\n          </button>\n          <button class="btn btn-primary" ng-click="save(cfgToEdit); isDetailExpanded = false;" ng-disabled="cfgForm.$invalid || cfgForm.$pristine" style="margin-left:0" translate>Save\n          </button>\n          <br>\n        </form>\n      </div>\n    </div>\n  </div>\n  <c8y-load-more></c8y-load-more>\n</div>',n.put("core_configurationRepository/views/list.html",e),n.put("/apps/core/configurationRepository/views/list.html",e)}angular.module("c8y.configurationRepository").run(["$templateCache",n])}();